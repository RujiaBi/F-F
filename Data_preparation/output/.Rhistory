data_6ass[i,3] <- unique(dd_6ass[dd_6ass$stock_comparison==data_6ass[i,5],]$region)
data_6ass[i,4] <- unique(dd_6ass[dd_6ass$stock_comparison==data_6ass[i,5],]$ty_order)
data_6ass[i,7] <- unique(dd_6ass[dd_6ass$stock_comparison==data_6ass[i,5],]$interval)
data_6ass[i,8] <- unique(dd_6ass[dd_6ass$stock_comparison==data_6ass[i,5],]$period)
data_6ass[i,9] <- unique(dd_6ass[dd_6ass$stock_comparison==data_6ass[i,5],]$ty)
data_6ass[i,10] <- NA
data_6ass[i,11] <- dd_6ass[dd_6ass$stock_comparison==data_6ass[i,5] & dd_6ass$assess_order==min(dd_6ass[dd_6ass$stock_comparison==data_6ass[i,5],]$assess_order),]$B_ty
data_6ass[i,12] <- dd_6ass[dd_6ass$stock_comparison==data_6ass[i,5] & dd_6ass$assess_order==max(dd_6ass[dd_6ass$stock_comparison==data_6ass[i,5],]$assess_order),]$B_ty
data_6ass[i,13] <- dd_6ass[dd_6ass$stock_comparison==data_6ass[i,5] & dd_6ass$assess_order==min(dd_6ass[dd_6ass$stock_comparison==data_6ass[i,5],]$assess_order),]$F_ty
data_6ass[i,14] <- dd_6ass[dd_6ass$stock_comparison==data_6ass[i,5] & dd_6ass$assess_order==max(dd_6ass[dd_6ass$stock_comparison==data_6ass[i,5],]$assess_order),]$F_ty
data_6ass[i,15] <- dd_6ass[dd_6ass$stock_comparison==data_6ass[i,5] & dd_6ass$assess_order==min(dd_6ass[dd_6ass$stock_comparison==data_6ass[i,5],]$assess_order),]$Bmsy
data_6ass[i,16] <- dd_6ass[dd_6ass$stock_comparison==data_6ass[i,5] & dd_6ass$assess_order==max(dd_6ass[dd_6ass$stock_comparison==data_6ass[i,5],]$assess_order),]$Bmsy
data_6ass[i,17] <- dd_6ass[dd_6ass$stock_comparison==data_6ass[i,5] & dd_6ass$assess_order==min(dd_6ass[dd_6ass$stock_comparison==data_6ass[i,5],]$assess_order),]$Fmsy
data_6ass[i,18] <- dd_6ass[dd_6ass$stock_comparison==data_6ass[i,5] & dd_6ass$assess_order==max(dd_6ass[dd_6ass$stock_comparison==data_6ass[i,5],]$assess_order),]$Fmsy
data_6ass[i,19] <- dd_6ass[dd_6ass$stock_comparison==data_6ass[i,5] & dd_6ass$assess_order==min(dd_6ass[dd_6ass$stock_comparison==data_6ass[i,5],]$assess_order),]$B_by_Bmsy
data_6ass[i,20] <- dd_6ass[dd_6ass$stock_comparison==data_6ass[i,5] & dd_6ass$assess_order==max(dd_6ass[dd_6ass$stock_comparison==data_6ass[i,5],]$assess_order),]$B_by_Bmsy
data_6ass[i,21] <- dd_6ass[dd_6ass$stock_comparison==data_6ass[i,5] & dd_6ass$assess_order==min(dd_6ass[dd_6ass$stock_comparison==data_6ass[i,5],]$assess_order),]$F_by_Fmsy
data_6ass[i,22] <- dd_6ass[dd_6ass$stock_comparison==data_6ass[i,5] & dd_6ass$assess_order==max(dd_6ass[dd_6ass$stock_comparison==data_6ass[i,5],]$assess_order),]$F_by_Fmsy
data_6ass[i,23] <- dd_6ass[dd_6ass$stock_comparison==data_6ass[i,5] & dd_6ass$assess_order==min(dd_6ass[dd_6ass$stock_comparison==data_6ass[i,5],]$assess_order),]$OFL_ty
data_6ass[i,24] <- dd_6ass[dd_6ass$stock_comparison==data_6ass[i,5] & dd_6ass$assess_order==max(dd_6ass[dd_6ass$stock_comparison==data_6ass[i,5],]$assess_order),]$OFL_ty
data_6ass[i,25] <- unique(dd_6ass[dd_6ass$stockid==data_6ass[i,1] & dd_6ass$ty==data_6ass[i,9] & dd_6ass$assess_order==min(dd_6ass[dd_6ass$stockid==data_6ass[i,1],]$assess_order),]$B_ty)
data_6ass[i,26] <- unique(dd_6ass[dd_6ass$stockid==data_6ass[i,1] & dd_6ass$ty==data_6ass[i,9] & dd_6ass$assess_order==min(dd_6ass[dd_6ass$stockid==data_6ass[i,1],]$assess_order),]$F_ty)
data_6ass[i,27] <- unique(dd_6ass[dd_6ass$stockid==data_6ass[i,1] & dd_6ass$ty==data_6ass[i,9] & dd_6ass$assess_order==min(dd_6ass[dd_6ass$stockid==data_6ass[i,1],]$assess_order),]$Bmsy)
data_6ass[i,28] <- unique(dd_6ass[dd_6ass$stockid==data_6ass[i,1] & dd_6ass$ty==data_6ass[i,9] & dd_6ass$assess_order==min(dd_6ass[dd_6ass$stockid==data_6ass[i,1],]$assess_order),]$Fmsy)
data_6ass[i,29] <- unique(dd_6ass[dd_6ass$stockid==data_6ass[i,1] & dd_6ass$ty==data_6ass[i,9] & dd_6ass$assess_order==min(dd_6ass[dd_6ass$stockid==data_6ass[i,1],]$assess_order),]$B_by_Bmsy)
data_6ass[i,30] <- unique(dd_6ass[dd_6ass$stockid==data_6ass[i,1] & dd_6ass$ty==data_6ass[i,9] & dd_6ass$assess_order==min(dd_6ass[dd_6ass$stockid==data_6ass[i,1],]$assess_order),]$F_by_Fmsy)
data_6ass[i,31] <- unique(dd_6ass[dd_6ass$stockid==data_6ass[i,1] & dd_6ass$ty==data_6ass[i,9] & dd_6ass$assess_order==min(dd_6ass[dd_6ass$stockid==data_6ass[i,1],]$assess_order),]$OFL_ty)
}
data_6ass$stockid_code <- as.numeric(as.factor(data_6ass$stockid))
data_6ass$ty_code <- NA
for (i in 1:length(unique(data_6ass$stockid))){
ty_vector <- sort(unique(data_6ass[data_6ass$stockid==unique(data_6ass$stockid)[i],]$ty))
for(j in 1:length(ty_vector)){
data_6ass[data_6ass$stockid==unique(data_6ass$stockid)[i] & data_6ass$ty==ty_vector[j],]$ty_code <- match(ty_vector, sort(unique(ty_vector)))[j]
}
}
data_6ass$num_assess <- 6
## Data with 7 assessments ##
dd_7ass$stock_comparison <- paste(dd_7ass$stockid, dd_7ass$ty_order, sep="_")
data_7ass <- as.data.frame(matrix(NA, nrow=length(unique(dd_7ass$stock_comparison)), ncol=31))
colnames(data_7ass) <- c("stockid", "stockid_code", "region", "comparison", "stock_comparison", "stock_comparison_code", "interval", "period",
"ty", "MethodChange", "B_recent", "B_old", "F_recent", "F_old", "Bmsy_recent", "Bmsy_old", "Fmsy_recent", "Fmsy_old",
"B_by_Bmsy_recent", "B_by_Bmsy_old", "F_by_Fmsy_recent", "F_by_Fmsy_old", "OFL_ty_recent", "OFL_ty_old", "mu_B", "mu_F",
"mu_Bmsy", "mu_Fmsy", "mu_B_by_Bmsy", "mu_F_by_Fmsy", "mu_OFL")
data_7ass$stock_comparison <- unique(dd_7ass$stock_comparison)
data_7ass$stock_comparison_code <- as.numeric(as.factor(data_7ass$stock_comparison))
for (i in 1:length(unique(dd_7ass$stock_comparison))){
data_7ass[i,1] <- unique(dd_7ass[dd_7ass$stock_comparison==data_7ass[i,5],]$stockid)
data_7ass[i,3] <- unique(dd_7ass[dd_7ass$stock_comparison==data_7ass[i,5],]$region)
data_7ass[i,4] <- unique(dd_7ass[dd_7ass$stock_comparison==data_7ass[i,5],]$ty_order)
data_7ass[i,7] <- unique(dd_7ass[dd_7ass$stock_comparison==data_7ass[i,5],]$interval)
data_7ass[i,8] <- unique(dd_7ass[dd_7ass$stock_comparison==data_7ass[i,5],]$period)
data_7ass[i,9] <- unique(dd_7ass[dd_7ass$stock_comparison==data_7ass[i,5],]$ty)
data_7ass[i,10] <- NA
data_7ass[i,11] <- dd_7ass[dd_7ass$stock_comparison==data_7ass[i,5] & dd_7ass$assess_order==min(dd_7ass[dd_7ass$stock_comparison==data_7ass[i,5],]$assess_order),]$B_ty
data_7ass[i,12] <- dd_7ass[dd_7ass$stock_comparison==data_7ass[i,5] & dd_7ass$assess_order==max(dd_7ass[dd_7ass$stock_comparison==data_7ass[i,5],]$assess_order),]$B_ty
data_7ass[i,13] <- dd_7ass[dd_7ass$stock_comparison==data_7ass[i,5] & dd_7ass$assess_order==min(dd_7ass[dd_7ass$stock_comparison==data_7ass[i,5],]$assess_order),]$F_ty
data_7ass[i,14] <- dd_7ass[dd_7ass$stock_comparison==data_7ass[i,5] & dd_7ass$assess_order==max(dd_7ass[dd_7ass$stock_comparison==data_7ass[i,5],]$assess_order),]$F_ty
data_7ass[i,15] <- dd_7ass[dd_7ass$stock_comparison==data_7ass[i,5] & dd_7ass$assess_order==min(dd_7ass[dd_7ass$stock_comparison==data_7ass[i,5],]$assess_order),]$Bmsy
data_7ass[i,16] <- dd_7ass[dd_7ass$stock_comparison==data_7ass[i,5] & dd_7ass$assess_order==max(dd_7ass[dd_7ass$stock_comparison==data_7ass[i,5],]$assess_order),]$Bmsy
data_7ass[i,17] <- dd_7ass[dd_7ass$stock_comparison==data_7ass[i,5] & dd_7ass$assess_order==min(dd_7ass[dd_7ass$stock_comparison==data_7ass[i,5],]$assess_order),]$Fmsy
data_7ass[i,18] <- dd_7ass[dd_7ass$stock_comparison==data_7ass[i,5] & dd_7ass$assess_order==max(dd_7ass[dd_7ass$stock_comparison==data_7ass[i,5],]$assess_order),]$Fmsy
data_7ass[i,19] <- dd_7ass[dd_7ass$stock_comparison==data_7ass[i,5] & dd_7ass$assess_order==min(dd_7ass[dd_7ass$stock_comparison==data_7ass[i,5],]$assess_order),]$B_by_Bmsy
data_7ass[i,20] <- dd_7ass[dd_7ass$stock_comparison==data_7ass[i,5] & dd_7ass$assess_order==max(dd_7ass[dd_7ass$stock_comparison==data_7ass[i,5],]$assess_order),]$B_by_Bmsy
data_7ass[i,21] <- dd_7ass[dd_7ass$stock_comparison==data_7ass[i,5] & dd_7ass$assess_order==min(dd_7ass[dd_7ass$stock_comparison==data_7ass[i,5],]$assess_order),]$F_by_Fmsy
data_7ass[i,22] <- dd_7ass[dd_7ass$stock_comparison==data_7ass[i,5] & dd_7ass$assess_order==max(dd_7ass[dd_7ass$stock_comparison==data_7ass[i,5],]$assess_order),]$F_by_Fmsy
data_7ass[i,23] <- dd_7ass[dd_7ass$stock_comparison==data_7ass[i,5] & dd_7ass$assess_order==min(dd_7ass[dd_7ass$stock_comparison==data_7ass[i,5],]$assess_order),]$OFL_ty
data_7ass[i,24] <- dd_7ass[dd_7ass$stock_comparison==data_7ass[i,5] & dd_7ass$assess_order==max(dd_7ass[dd_7ass$stock_comparison==data_7ass[i,5],]$assess_order),]$OFL_ty
data_7ass[i,25] <- unique(dd_7ass[dd_7ass$stockid==data_7ass[i,1] & dd_7ass$ty==data_7ass[i,9] & dd_7ass$assess_order==min(dd_7ass[dd_7ass$stockid==data_7ass[i,1],]$assess_order),]$B_ty)
data_7ass[i,26] <- unique(dd_7ass[dd_7ass$stockid==data_7ass[i,1] & dd_7ass$ty==data_7ass[i,9] & dd_7ass$assess_order==min(dd_7ass[dd_7ass$stockid==data_7ass[i,1],]$assess_order),]$F_ty)
data_7ass[i,27] <- unique(dd_7ass[dd_7ass$stockid==data_7ass[i,1] & dd_7ass$ty==data_7ass[i,9] & dd_7ass$assess_order==min(dd_7ass[dd_7ass$stockid==data_7ass[i,1],]$assess_order),]$Bmsy)
data_7ass[i,28] <- unique(dd_7ass[dd_7ass$stockid==data_7ass[i,1] & dd_7ass$ty==data_7ass[i,9] & dd_7ass$assess_order==min(dd_7ass[dd_7ass$stockid==data_7ass[i,1],]$assess_order),]$Fmsy)
data_7ass[i,29] <- unique(dd_7ass[dd_7ass$stockid==data_7ass[i,1] & dd_7ass$ty==data_7ass[i,9] & dd_7ass$assess_order==min(dd_7ass[dd_7ass$stockid==data_7ass[i,1],]$assess_order),]$B_by_Bmsy)
data_7ass[i,30] <- unique(dd_7ass[dd_7ass$stockid==data_7ass[i,1] & dd_7ass$ty==data_7ass[i,9] & dd_7ass$assess_order==min(dd_7ass[dd_7ass$stockid==data_7ass[i,1],]$assess_order),]$F_by_Fmsy)
data_7ass[i,31] <- unique(dd_7ass[dd_7ass$stockid==data_7ass[i,1] & dd_7ass$ty==data_7ass[i,9] & dd_7ass$assess_order==min(dd_7ass[dd_7ass$stockid==data_7ass[i,1],]$assess_order),]$OFL_ty)
}
data_7ass$stockid_code <- as.numeric(as.factor(data_7ass$stockid))
data_7ass$ty_code <- NA
for (i in 1:length(unique(data_7ass$stockid))){
ty_vector <- sort(unique(data_7ass[data_7ass$stockid==unique(data_7ass$stockid)[i],]$ty))
for(j in 1:length(ty_vector)){
data_7ass[data_7ass$stockid==unique(data_7ass$stockid)[i] & data_7ass$ty==ty_vector[j],]$ty_code <- match(ty_vector, sort(unique(ty_vector)))[j]
}
}
data_7ass$num_assess <- 7
## Data with 8 assessments ##
dd_8ass$stock_comparison <- paste(dd_8ass$stockid, dd_8ass$ty_order, sep="_")
data_8ass <- as.data.frame(matrix(NA, nrow=length(unique(dd_8ass$stock_comparison)), ncol=31))
colnames(data_8ass) <- c("stockid", "stockid_code", "region", "comparison", "stock_comparison", "stock_comparison_code", "interval", "period",
"ty", "MethodChange", "B_recent", "B_old", "F_recent", "F_old", "Bmsy_recent", "Bmsy_old", "Fmsy_recent", "Fmsy_old",
"B_by_Bmsy_recent", "B_by_Bmsy_old", "F_by_Fmsy_recent", "F_by_Fmsy_old", "OFL_ty_recent", "OFL_ty_old", "mu_B", "mu_F",
"mu_Bmsy", "mu_Fmsy", "mu_B_by_Bmsy", "mu_F_by_Fmsy", "mu_OFL")
data_8ass$stock_comparison <- unique(dd_8ass$stock_comparison)
data_8ass$stock_comparison_code <- as.numeric(as.factor(data_8ass$stock_comparison))
for (i in 1:length(unique(dd_8ass$stock_comparison))){
data_8ass[i,1] <- unique(dd_8ass[dd_8ass$stock_comparison==data_8ass[i,5],]$stockid)
data_8ass[i,3] <- unique(dd_8ass[dd_8ass$stock_comparison==data_8ass[i,5],]$region)
data_8ass[i,4] <- unique(dd_8ass[dd_8ass$stock_comparison==data_8ass[i,5],]$ty_order)
data_8ass[i,7] <- unique(dd_8ass[dd_8ass$stock_comparison==data_8ass[i,5],]$interval)
data_8ass[i,8] <- unique(dd_8ass[dd_8ass$stock_comparison==data_8ass[i,5],]$period)
data_8ass[i,9] <- unique(dd_8ass[dd_8ass$stock_comparison==data_8ass[i,5],]$ty)
data_8ass[i,10] <- NA
data_8ass[i,11] <- dd_8ass[dd_8ass$stock_comparison==data_8ass[i,5] & dd_8ass$assess_order==min(dd_8ass[dd_8ass$stock_comparison==data_8ass[i,5],]$assess_order),]$B_ty
data_8ass[i,12] <- dd_8ass[dd_8ass$stock_comparison==data_8ass[i,5] & dd_8ass$assess_order==max(dd_8ass[dd_8ass$stock_comparison==data_8ass[i,5],]$assess_order),]$B_ty
data_8ass[i,13] <- dd_8ass[dd_8ass$stock_comparison==data_8ass[i,5] & dd_8ass$assess_order==min(dd_8ass[dd_8ass$stock_comparison==data_8ass[i,5],]$assess_order),]$F_ty
data_8ass[i,14] <- dd_8ass[dd_8ass$stock_comparison==data_8ass[i,5] & dd_8ass$assess_order==max(dd_8ass[dd_8ass$stock_comparison==data_8ass[i,5],]$assess_order),]$F_ty
data_8ass[i,15] <- dd_8ass[dd_8ass$stock_comparison==data_8ass[i,5] & dd_8ass$assess_order==min(dd_8ass[dd_8ass$stock_comparison==data_8ass[i,5],]$assess_order),]$Bmsy
data_8ass[i,16] <- dd_8ass[dd_8ass$stock_comparison==data_8ass[i,5] & dd_8ass$assess_order==max(dd_8ass[dd_8ass$stock_comparison==data_8ass[i,5],]$assess_order),]$Bmsy
data_8ass[i,17] <- dd_8ass[dd_8ass$stock_comparison==data_8ass[i,5] & dd_8ass$assess_order==min(dd_8ass[dd_8ass$stock_comparison==data_8ass[i,5],]$assess_order),]$Fmsy
data_8ass[i,18] <- dd_8ass[dd_8ass$stock_comparison==data_8ass[i,5] & dd_8ass$assess_order==max(dd_8ass[dd_8ass$stock_comparison==data_8ass[i,5],]$assess_order),]$Fmsy
data_8ass[i,19] <- dd_8ass[dd_8ass$stock_comparison==data_8ass[i,5] & dd_8ass$assess_order==min(dd_8ass[dd_8ass$stock_comparison==data_8ass[i,5],]$assess_order),]$B_by_Bmsy
data_8ass[i,20] <- dd_8ass[dd_8ass$stock_comparison==data_8ass[i,5] & dd_8ass$assess_order==max(dd_8ass[dd_8ass$stock_comparison==data_8ass[i,5],]$assess_order),]$B_by_Bmsy
data_8ass[i,21] <- dd_8ass[dd_8ass$stock_comparison==data_8ass[i,5] & dd_8ass$assess_order==min(dd_8ass[dd_8ass$stock_comparison==data_8ass[i,5],]$assess_order),]$F_by_Fmsy
data_8ass[i,22] <- dd_8ass[dd_8ass$stock_comparison==data_8ass[i,5] & dd_8ass$assess_order==max(dd_8ass[dd_8ass$stock_comparison==data_8ass[i,5],]$assess_order),]$F_by_Fmsy
data_8ass[i,23] <- dd_8ass[dd_8ass$stock_comparison==data_8ass[i,5] & dd_8ass$assess_order==min(dd_8ass[dd_8ass$stock_comparison==data_8ass[i,5],]$assess_order),]$OFL_ty
data_8ass[i,24] <- dd_8ass[dd_8ass$stock_comparison==data_8ass[i,5] & dd_8ass$assess_order==max(dd_8ass[dd_8ass$stock_comparison==data_8ass[i,5],]$assess_order),]$OFL_ty
data_8ass[i,25] <- unique(dd_8ass[dd_8ass$stockid==data_8ass[i,1] & dd_8ass$ty==data_8ass[i,9] & dd_8ass$assess_order==min(dd_8ass[dd_8ass$stockid==data_8ass[i,1],]$assess_order),]$B_ty)
data_8ass[i,26] <- unique(dd_8ass[dd_8ass$stockid==data_8ass[i,1] & dd_8ass$ty==data_8ass[i,9] & dd_8ass$assess_order==min(dd_8ass[dd_8ass$stockid==data_8ass[i,1],]$assess_order),]$F_ty)
data_8ass[i,27] <- unique(dd_8ass[dd_8ass$stockid==data_8ass[i,1] & dd_8ass$ty==data_8ass[i,9] & dd_8ass$assess_order==min(dd_8ass[dd_8ass$stockid==data_8ass[i,1],]$assess_order),]$Bmsy)
data_8ass[i,28] <- unique(dd_8ass[dd_8ass$stockid==data_8ass[i,1] & dd_8ass$ty==data_8ass[i,9] & dd_8ass$assess_order==min(dd_8ass[dd_8ass$stockid==data_8ass[i,1],]$assess_order),]$Fmsy)
data_8ass[i,29] <- unique(dd_8ass[dd_8ass$stockid==data_8ass[i,1] & dd_8ass$ty==data_8ass[i,9] & dd_8ass$assess_order==min(dd_8ass[dd_8ass$stockid==data_8ass[i,1],]$assess_order),]$B_by_Bmsy)
data_8ass[i,30] <- unique(dd_8ass[dd_8ass$stockid==data_8ass[i,1] & dd_8ass$ty==data_8ass[i,9] & dd_8ass$assess_order==min(dd_8ass[dd_8ass$stockid==data_8ass[i,1],]$assess_order),]$F_by_Fmsy)
data_8ass[i,31] <- unique(dd_8ass[dd_8ass$stockid==data_8ass[i,1] & dd_8ass$ty==data_8ass[i,9] & dd_8ass$assess_order==min(dd_8ass[dd_8ass$stockid==data_8ass[i,1],]$assess_order),]$OFL_ty)
}
data_8ass$stockid_code <- as.numeric(as.factor(data_8ass$stockid))
data_8ass$ty_code <- NA
for (i in 1:length(unique(data_8ass$stockid))){
ty_vector <- sort(unique(data_8ass[data_8ass$stockid==unique(data_8ass$stockid)[i],]$ty))
for(j in 1:length(ty_vector)){
data_8ass[data_8ass$stockid==unique(data_8ass$stockid)[i] & data_8ass$ty==ty_vector[j],]$ty_code <- match(ty_vector, sort(unique(ty_vector)))[j]
}
}
data_8ass$num_assess <- 8
####################################################################################################################
## Put data together ##
data_full <- rbind(data_2ass, data_3ass, data_4ass, data_5ass, data_6ass, data_7ass, data_8ass)
data_full
data_full[data_full$num_assess==3,]
data_full[data_full$num_assess==3 & data_full$stockid=="PLAICIS",]
## Put data together ##
data_full <- rbind(data_2ass, data_3ass, data_4ass, data_5ass, data_6ass, data_7ass, data_8ass)
write.csv(data_full, paste(outputdir, "0h_data_full_model.csv", sep="/"), row.names=F)
# Clear workspace
rm(list = ls())
# Turn off scientific notation
options(scipen=999)
# Packages
library(plyr)
library(dplyr)
load("/Users/rujiabi/Desktop/Climate_Stock/RAMLDB v4.491/DB Files With Assessment Data/R Data/DBdata[asmt][v4.491].RData")
outputdir <- "~/Desktop/Climate_Stock/Bi_Code/B_F_OFL_dist/Data_preparation/output"
dd_2ass <- read.csv(paste(outputdir, "0g_1_data_2_assess_msy_ofl.csv", sep="/"), as.is=T)
dd_3ass <- read.csv(paste(outputdir, "0g_2_data_3_assess_msy_ofl.csv", sep="/"), as.is=T)
dd_4ass <- read.csv(paste(outputdir, "0g_3_data_4_assess_msy_ofl.csv", sep="/"), as.is=T)
dd_5ass <- read.csv(paste(outputdir, "0g_4_data_5_assess_msy_ofl.csv", sep="/"), as.is=T)
dd_6ass <- read.csv(paste(outputdir, "0g_5_data_6_assess_msy_ofl.csv", sep="/"), as.is=T)
dd_7ass <- read.csv(paste(outputdir, "0g_6_data_7_assess_msy_ofl.csv", sep="/"), as.is=T)
dd_8ass <- read.csv(paste(outputdir, "0g_7_data_8_assess_msy_ofl.csv", sep="/"), as.is=T)
# Find records with problems
dd_6ass[dd_6ass$assessid=="WGCSE-CODVIa-1981-2012-CHING",]$F_ty <- NA
dd_2ass[dd_2ass$assessid=="MARAM-CRLOBSTERSA7-1910-2012-Johnston",]$F_ty <- NA
dd_2ass[dd_2ass$assessid=="NZMFishLOBSTERWG-RROCKLOBSTERCRA3-1945-2007-JENSEN",]$F_ty <- NA
dd_7ass[dd_7ass$assessid=="WGNSDS-SOLEIS-1968-2011-NEUBAUER",]$F_ty <- NA
dd_2ass[dd_2ass$assessid=="ISC-PACBTUNA-1952-2012-PONS",]$Fmsy <- NA
dd_2ass[dd_2ass$stockid=="SARDSA",]$B_by_Bmsy <- NA
dd_2ass[dd_2ass$stockid=="WAREHOUESE",]$Bmsy <- NA
# Clear workspace
rm(list = ls())
# Turn off scientific notation
options(scipen=999)
# Packages
library(plyr)
library(dplyr)
##############################################################################################################
# Define directories
load("/Users/rujiabi/Desktop/Climate_Stock/RAMLDB v4.491/DB Files With Assessment Data/R Data/DBdata[asmt][v4.491].RData")
outputdir <- "~/Desktop/Climate_Stock/Bi_Code/B_F_OFL_dist/Data_preparation/output"
dd_2ass <- read.csv(paste(outputdir, "0g_1_data_2_assess_msy_ofl.csv", sep="/"), as.is=T)
dd_3ass <- read.csv(paste(outputdir, "0g_2_data_3_assess_msy_ofl.csv", sep="/"), as.is=T)
dd_4ass <- read.csv(paste(outputdir, "0g_3_data_4_assess_msy_ofl.csv", sep="/"), as.is=T)
dd_5ass <- read.csv(paste(outputdir, "0g_4_data_5_assess_msy_ofl.csv", sep="/"), as.is=T)
dd_6ass <- read.csv(paste(outputdir, "0g_5_data_6_assess_msy_ofl.csv", sep="/"), as.is=T)
dd_7ass <- read.csv(paste(outputdir, "0g_6_data_7_assess_msy_ofl.csv", sep="/"), as.is=T)
dd_8ass <- read.csv(paste(outputdir, "0g_7_data_8_assess_msy_ofl.csv", sep="/"), as.is=T)
# Find records with problems
dd_6ass[dd_6ass$assessid=="WGCSE-CODVIa-1981-2012-CHING",]$F_ty <- NA
dd_2ass[dd_2ass$assessid=="MARAM-CRLOBSTERSA7-1910-2012-Johnston",]$F_ty <- NA
dd_2ass[dd_2ass$assessid=="NZMFishLOBSTERWG-RROCKLOBSTERCRA3-1945-2007-JENSEN",]$F_ty <- NA
dd_7ass[dd_7ass$assessid=="WGNSDS-SOLEIS-1968-2011-NEUBAUER",]$F_ty <- NA
dd_2ass[dd_2ass$assessid=="ISC-PACBTUNA-1952-2012-PONS",]$Fmsy <- NA
dd_2ass[dd_2ass$stockid=="SARDSA",]$B_by_Bmsy <- NA
dd_2ass[dd_2ass$stockid=="WAREHOUESE",]$Bmsy <- NA
## Data with 2 assessments ##
dd_2ass$stock_comparison <- paste(dd_2ass$stockid, dd_2ass$ty_order, sep="_")
data_2ass <- as.data.frame(matrix(NA, nrow=length(unique(dd_2ass$stock_comparison)), ncol=9))
colnames(data_2ass) <- c("stockid", "stockid_code", "region", "comparison", "stock_comparison", "stock_comparison_code", "period", "ty",
"MethodChange")
data_2ass$stock_comparison <- unique(dd_2ass$stock_comparison)
data_2ass$stock_comparison_code <- as.numeric(as.factor(data_2ass$stock_comparison))
for (i in 1:length(unique(dd_2ass$stock_comparison))){
data_2ass[i,1] <- unique(dd_2ass[dd_2ass$stock_comparison==data_2ass[i,5],]$stockid)
data_2ass[i,3] <- unique(dd_2ass[dd_2ass$stock_comparison==data_2ass[i,5],]$RegionCode)
data_2ass[i,4] <- unique(dd_2ass[dd_2ass$stock_comparison==data_2ass[i,5],]$ty_order)
data_2ass[i,7] <- unique(dd_2ass[dd_2ass$stock_comparison==data_2ass[i,5],]$period)
data_2ass[i,8] <- unique(dd_2ass[dd_2ass$stock_comparison==data_2ass[i,5],]$ty)
data_2ass[i,9] <- paste(dd_2ass[dd_2ass$stock_comparison==data_2ass[i,5] & dd_2ass$assess_order==max(dd_2ass[dd_2ass$stock_comparison==data_2ass[i,5],]$assess_order),]$method_pdf,
dd_2ass[dd_2ass$stock_comparison==data_2ass[i,5] & dd_2ass$assess_order==min(dd_2ass[dd_2ass$stock_comparison==data_2ass[i,5],]$assess_order),]$method_pdf,
sep="->")
}
dd_2ass$stock_comparison <- paste(dd_2ass$stockid, dd_2ass$ty_order, sep="_")
data_2ass <- as.data.frame(matrix(NA, nrow=length(unique(dd_2ass$stock_comparison)), ncol=9))
colnames(data_2ass) <- c("stockid", "stockid_code", "region", "comparison", "stock_comparison", "stock_comparison_code", "period", "ty",
"MethodChange")
data_2ass$stock_comparison <- unique(dd_2ass$stock_comparison)
data_2ass$stock_comparison_code <- as.numeric(as.factor(data_2ass$stock_comparison))
length(unique(dd_2ass$stock_comparison))
for (i in 1:length(unique(dd_2ass$stock_comparison))){
data_2ass[i,1] <- unique(dd_2ass[dd_2ass$stock_comparison==data_2ass[i,5],]$stockid)
data_2ass[i,3] <- unique(dd_2ass[dd_2ass$stock_comparison==data_2ass[i,5],]$RegionCode)
data_2ass[i,4] <- unique(dd_2ass[dd_2ass$stock_comparison==data_2ass[i,5],]$ty_order)
data_2ass[i,7] <- unique(dd_2ass[dd_2ass$stock_comparison==data_2ass[i,5],]$period)
data_2ass[i,8] <- unique(dd_2ass[dd_2ass$stock_comparison==data_2ass[i,5],]$ty)
data_2ass[i,9] <- paste(dd_2ass[dd_2ass$stock_comparison==data_2ass[i,5] & dd_2ass$assess_order==max(dd_2ass[dd_2ass$stock_comparison==data_2ass[i,5],]$assess_order),]$method_pdf,
dd_2ass[dd_2ass$stock_comparison==data_2ass[i,5] & dd_2ass$assess_order==min(dd_2ass[dd_2ass$stock_comparison==data_2ass[i,5],]$assess_order),]$method_pdf,
sep="->")
}
i
unique(dd_2ass[dd_2ass$stock_comparison==data_2ass[i,5],]$stockid)
data_2ass[i,1]
unique(dd_2ass[dd_2ass$stock_comparison==data_2ass[i,5],]$RegionCode)
dd_2ass[dd_2ass$stock_comparison==data_2ass[i,5],]$RegionCode
dd_2ass$stock_comparison <- paste(dd_2ass$stockid, dd_2ass$ty_order, sep="_")
data_2ass <- as.data.frame(matrix(NA, nrow=length(unique(dd_2ass$stock_comparison)), ncol=4))
colnames(data_2ass) <- c("stockid", "comparison", "stock_comparison", "MethodChange")
data_2ass$stock_comparison <- unique(dd_2ass$stock_comparison)
for (i in 1:length(unique(dd_2ass$stock_comparison))){
data_2ass[i,1] <- unique(dd_2ass[dd_2ass$stock_comparison==data_2ass[i,5],]$stockid)
data_2ass[i,2] <- unique(dd_2ass[dd_2ass$stock_comparison==data_2ass[i,5],]$ty_order)
data_2ass[i,4] <- paste(dd_2ass[dd_2ass$stock_comparison==data_2ass[i,5] & dd_2ass$assess_order==max(dd_2ass[dd_2ass$stock_comparison==data_2ass[i,5],]$assess_order),]$method_pdf,
dd_2ass[dd_2ass$stock_comparison==data_2ass[i,5] & dd_2ass$assess_order==min(dd_2ass[dd_2ass$stock_comparison==data_2ass[i,5],]$assess_order),]$method_pdf,
sep="->")
}
unique(dd_2ass[dd_2ass$stock_comparison==data_2ass[i,5],]$ty_order)
data_2ass$stock_comparison
colnames(dd_2ass)
dd_2ass$stock_comparison <- paste(dd_2ass$stockid, dd_2ass$ty_order, sep="_")
data_2ass <- as.data.frame(matrix(NA, nrow=length(unique(dd_2ass$stock_comparison)), ncol=4))
colnames(data_2ass) <- c("stockid", "comparison", "stock_comparison", "MethodChange")
data_2ass$stock_comparison <- unique(dd_2ass$stock_comparison)
for (i in 1:length(unique(dd_2ass$stock_comparison))){
data_2ass[i,1] <- unique(dd_2ass[dd_2ass$stock_comparison==data_2ass[i,3],]$stockid)
data_2ass[i,2] <- unique(dd_2ass[dd_2ass$stock_comparison==data_2ass[i,3],]$ty_order)
data_2ass[i,4] <- paste(dd_2ass[dd_2ass$stock_comparison==data_2ass[i,3] & dd_2ass$assess_order==max(dd_2ass[dd_2ass$stock_comparison==data_2ass[i,3],]$assess_order),]$method_pdf,
dd_2ass[dd_2ass$stock_comparison==data_2ass[i,3] & dd_2ass$assess_order==min(dd_2ass[dd_2ass$stock_comparison==data_2ass[i,3],]$assess_order),]$method_pdf,
sep="->")
}
unique(dd_2ass[dd_2ass$stock_comparison==data_2ass[i,3],]$stockid)
unique(dd_2ass[dd_2ass$stock_comparison==data_2ass[i,3],]$ty_order)
paste(dd_2ass[dd_2ass$stock_comparison==data_2ass[i,3] & dd_2ass$assess_order==max(dd_2ass[dd_2ass$stock_comparison==data_2ass[i,3],]$assess_order),]$method_pdf,
dd_2ass[dd_2ass$stock_comparison==data_2ass[i,3] & dd_2ass$assess_order==min(dd_2ass[dd_2ass$stock_comparison==data_2ass[i,3],]$assess_order),]$method_pdf,
sep="->")
dd_2ass[dd_2ass$stock_comparison==data_2ass[i,3] & dd_2ass$assess_order==max(dd_2ass[dd_2ass$stock_comparison==data_2ass[i,3],]$assess_order),]$method_pdf
colnames(dd_2ass)
# Clear workspace
rm(list = ls())
# Turn off scientific notation
options(scipen=999)
# Packages
library(plyr)
library(dplyr)
##############################################################################################################
# Define directories
load("/Users/rujiabi/Desktop/Climate_Stock/RAMLDB v4.491/DB Files With Assessment Data/R Data/DBdata[asmt][v4.491].RData")
outputdir <- "~/Desktop/Climate_Stock/Bi_Code/B_F_OFL_dist/Data_preparation/output"
dd_2ass <- read.csv(paste(outputdir, "0g_1_data_2_assess_msy_ofl.csv", sep="/"), as.is=T)
dd_3ass <- read.csv(paste(outputdir, "0g_2_data_3_assess_msy_ofl.csv", sep="/"), as.is=T)
dd_4ass <- read.csv(paste(outputdir, "0g_3_data_4_assess_msy_ofl.csv", sep="/"), as.is=T)
dd_5ass <- read.csv(paste(outputdir, "0g_4_data_5_assess_msy_ofl.csv", sep="/"), as.is=T)
dd_6ass <- read.csv(paste(outputdir, "0g_5_data_6_assess_msy_ofl.csv", sep="/"), as.is=T)
dd_7ass <- read.csv(paste(outputdir, "0g_6_data_7_assess_msy_ofl.csv", sep="/"), as.is=T)
dd_8ass <- read.csv(paste(outputdir, "0g_7_data_8_assess_msy_ofl.csv", sep="/"), as.is=T)
colnames(dd_2ass)
dd_2ass$stock_comparison <- paste(dd_2ass$stockid, dd_2ass$ty_order, sep="_")
data_2ass <- as.data.frame(matrix(NA, nrow=length(unique(dd_2ass$stock_comparison)), ncol=4))
colnames(data_2ass) <- c("stockid", "comparison", "stock_comparison", "MethodChange")
data_2ass$stock_comparison <- unique(dd_2ass$stock_comparison)
for (i in 1:length(unique(dd_2ass$stock_comparison))){
data_2ass[i,1] <- unique(dd_2ass[dd_2ass$stock_comparison==data_2ass[i,3],]$stockid)
data_2ass[i,2] <- unique(dd_2ass[dd_2ass$stock_comparison==data_2ass[i,3],]$ty_order)
data_2ass[i,4] <- paste(dd_2ass[dd_2ass$stock_comparison==data_2ass[i,3] & dd_2ass$assess_order==max(dd_2ass[dd_2ass$stock_comparison==data_2ass[i,3],]$assess_order),]$method,
dd_2ass[dd_2ass$stock_comparison==data_2ass[i,3] & dd_2ass$assess_order==min(dd_2ass[dd_2ass$stock_comparison==data_2ass[i,3],]$assess_order),]$method,
sep="->")
}
# Clear workspace
rm(list = ls())
# Turn off scientific notation
options(scipen=999)
# Packages
library(plyr)
library(dplyr)
##############################################################################################################
# Define directories
load("/Users/rujiabi/Desktop/Climate_Stock/RAMLDB v4.491/DB Files With Assessment Data/R Data/DBdata[asmt][v4.491].RData")
outputdir <- "~/Desktop/Climate_Stock/Bi_Code/B_F_OFL_dist/Data_preparation/output"
dd_2ass <- read.csv(paste(outputdir, "0g_1_data_2_assess_msy_ofl.csv", sep="/"), as.is=T)
dd_3ass <- read.csv(paste(outputdir, "0g_2_data_3_assess_msy_ofl.csv", sep="/"), as.is=T)
dd_4ass <- read.csv(paste(outputdir, "0g_3_data_4_assess_msy_ofl.csv", sep="/"), as.is=T)
dd_5ass <- read.csv(paste(outputdir, "0g_4_data_5_assess_msy_ofl.csv", sep="/"), as.is=T)
dd_6ass <- read.csv(paste(outputdir, "0g_5_data_6_assess_msy_ofl.csv", sep="/"), as.is=T)
dd_7ass <- read.csv(paste(outputdir, "0g_6_data_7_assess_msy_ofl.csv", sep="/"), as.is=T)
dd_8ass <- read.csv(paste(outputdir, "0g_7_data_8_assess_msy_ofl.csv", sep="/"), as.is=T)
#####################################################################################################################
## Data with 2 assessments ##
dd_2ass$stock_comparison <- paste(dd_2ass$stockid, dd_2ass$ty_order, sep="_")
data_2ass <- as.data.frame(matrix(NA, nrow=length(unique(dd_2ass$stock_comparison)), ncol=4))
colnames(data_2ass) <- c("stockid", "comparison", "stock_comparison", "MethodChange")
data_2ass$stock_comparison <- unique(dd_2ass$stock_comparison)
for (i in 1:length(unique(dd_2ass$stock_comparison))){
data_2ass[i,1] <- unique(dd_2ass[dd_2ass$stock_comparison==data_2ass[i,3],]$stockid)
data_2ass[i,2] <- unique(dd_2ass[dd_2ass$stock_comparison==data_2ass[i,3],]$ty_order)
data_2ass[i,4] <- paste(dd_2ass[dd_2ass$stock_comparison==data_2ass[i,3] & dd_2ass$assess_order==max(dd_2ass[dd_2ass$stock_comparison==data_2ass[i,3],]$assess_order),]$method,
dd_2ass[dd_2ass$stock_comparison==data_2ass[i,3] & dd_2ass$assess_order==min(dd_2ass[dd_2ass$stock_comparison==data_2ass[i,3],]$assess_order),]$method,
sep="->")
}
## Data with 3 assessments ##
dd_3ass$stock_comparison <- paste(dd_3ass$stockid, dd_3ass$ty_order, sep="_")
data_3ass <- as.data.frame(matrix(NA, nrow=length(unique(dd_3ass$stock_comparison)), ncol=4))
colnames(data_3ass) <- c("stockid", "comparison", "stock_comparison", "MethodChange")
data_3ass$stock_comparison <- unique(dd_3ass$stock_comparison)
for (i in 1:length(unique(dd_3ass$stock_comparison))){
data_3ass[i,1] <- unique(dd_3ass[dd_3ass$stock_comparison==data_3ass[i,3],]$stockid)
data_3ass[i,2] <- unique(dd_3ass[dd_3ass$stock_comparison==data_3ass[i,3],]$ty_order)
data_3ass[i,4] <- paste(dd_3ass[dd_3ass$stock_comparison==data_3ass[i,3] & dd_3ass$assess_order==max(dd_3ass[dd_3ass$stock_comparison==data_3ass[i,3],]$assess_order),]$method,
dd_3ass[dd_3ass$stock_comparison==data_3ass[i,3] & dd_3ass$assess_order==min(dd_3ass[dd_3ass$stock_comparison==data_3ass[i,3],]$assess_order),]$method,
sep="->")
}
## Data with 4 assessments ##
dd_4ass$stock_comparison <- paste(dd_4ass$stockid, dd_4ass$ty_order, sep="_")
data_4ass <- as.data.frame(matrix(NA, nrow=length(unique(dd_4ass$stock_comparison)), ncol=4))
colnames(data_4ass) <- c("stockid", "comparison", "stock_comparison", "MethodChange")
data_4ass$stock_comparison <- unique(dd_4ass$stock_comparison)
for (i in 1:length(unique(dd_4ass$stock_comparison))){
data_4ass[i,1] <- unique(dd_4ass[dd_4ass$stock_comparison==data_4ass[i,3],]$stockid)
data_4ass[i,2] <- unique(dd_4ass[dd_4ass$stock_comparison==data_4ass[i,3],]$ty_order)
data_4ass[i,4] <- paste(dd_4ass[dd_4ass$stock_comparison==data_4ass[i,3] & dd_4ass$assess_order==max(dd_4ass[dd_4ass$stock_comparison==data_4ass[i,3],]$assess_order),]$method,
dd_4ass[dd_4ass$stock_comparison==data_4ass[i,3] & dd_4ass$assess_order==min(dd_4ass[dd_4ass$stock_comparison==data_4ass[i,3],]$assess_order),]$method,
sep="->")
}
## Data with 5 assessments ##
dd_5ass$stock_comparison <- paste(dd_5ass$stockid, dd_5ass$ty_order, sep="_")
data_5ass <- as.data.frame(matrix(NA, nrow=length(unique(dd_5ass$stock_comparison)), ncol=4))
colnames(data_5ass) <- c("stockid", "comparison", "stock_comparison", "MethodChange")
data_5ass$stock_comparison <- unique(dd_5ass$stock_comparison)
for (i in 1:length(unique(dd_5ass$stock_comparison))){
data_5ass[i,1] <- unique(dd_5ass[dd_5ass$stock_comparison==data_5ass[i,3],]$stockid)
data_5ass[i,2] <- unique(dd_5ass[dd_5ass$stock_comparison==data_5ass[i,3],]$ty_order)
data_5ass[i,4] <- paste(dd_5ass[dd_5ass$stock_comparison==data_5ass[i,3] & dd_5ass$assess_order==max(dd_5ass[dd_5ass$stock_comparison==data_5ass[i,3],]$assess_order),]$method,
dd_5ass[dd_5ass$stock_comparison==data_5ass[i,3] & dd_5ass$assess_order==min(dd_5ass[dd_5ass$stock_comparison==data_5ass[i,3],]$assess_order),]$method,
sep="->")
}
## Data with 6 assessments ##
dd_6ass$stock_comparison <- paste(dd_6ass$stockid, dd_6ass$ty_order, sep="_")
data_6ass <- as.data.frame(matrix(NA, nrow=length(unique(dd_6ass$stock_comparison)), ncol=4))
colnames(data_6ass) <- c("stockid", "comparison", "stock_comparison", "MethodChange")
data_6ass$stock_comparison <- unique(dd_6ass$stock_comparison)
for (i in 1:length(unique(dd_6ass$stock_comparison))){
data_6ass[i,1] <- unique(dd_6ass[dd_6ass$stock_comparison==data_6ass[i,3],]$stockid)
data_6ass[i,2] <- unique(dd_6ass[dd_6ass$stock_comparison==data_6ass[i,3],]$ty_order)
data_6ass[i,4] <- paste(dd_6ass[dd_6ass$stock_comparison==data_6ass[i,3] & dd_6ass$assess_order==max(dd_6ass[dd_6ass$stock_comparison==data_6ass[i,3],]$assess_order),]$method,
dd_6ass[dd_6ass$stock_comparison==data_6ass[i,3] & dd_6ass$assess_order==min(dd_6ass[dd_6ass$stock_comparison==data_6ass[i,3],]$assess_order),]$method,
sep="->")
}
## Data with 7 assessments ##
dd_7ass$stock_comparison <- paste(dd_7ass$stockid, dd_7ass$ty_order, sep="_")
data_7ass <- as.data.frame(matrix(NA, nrow=length(unique(dd_7ass$stock_comparison)), ncol=4))
colnames(data_7ass) <- c("stockid", "comparison", "stock_comparison", "MethodChange")
data_7ass$stock_comparison <- unique(dd_7ass$stock_comparison)
for (i in 1:length(unique(dd_7ass$stock_comparison))){
data_7ass[i,1] <- unique(dd_7ass[dd_7ass$stock_comparison==data_7ass[i,3],]$stockid)
data_7ass[i,2] <- unique(dd_7ass[dd_7ass$stock_comparison==data_7ass[i,3],]$ty_order)
data_7ass[i,4] <- paste(dd_7ass[dd_7ass$stock_comparison==data_7ass[i,3] & dd_7ass$assess_order==max(dd_7ass[dd_7ass$stock_comparison==data_7ass[i,3],]$assess_order),]$method,
dd_7ass[dd_7ass$stock_comparison==data_7ass[i,3] & dd_7ass$assess_order==min(dd_7ass[dd_7ass$stock_comparison==data_7ass[i,3],]$assess_order),]$method,
sep="->")
}
## Data with 8 assessments ##
dd_8ass$stock_comparison <- paste(dd_8ass$stockid, dd_8ass$ty_order, sep="_")
data_8ass <- as.data.frame(matrix(NA, nrow=length(unique(dd_8ass$stock_comparison)), ncol=4))
colnames(data_8ass) <- c("stockid", "comparison", "stock_comparison", "MethodChange")
data_8ass$stock_comparison <- unique(dd_8ass$stock_comparison)
data_8ass$stock_comparison_code <- as.numeric(as.factor(data_8ass$stock_comparison))
for (i in 1:length(unique(dd_8ass$stock_comparison))){
data_8ass[i,1] <- unique(dd_8ass[dd_8ass$stock_comparison==data_8ass[i,3],]$stockid)
data_8ass[i,2] <- unique(dd_8ass[dd_8ass$stock_comparison==data_8ass[i,3],]$ty_order)
data_8ass[i,4] <- paste(dd_8ass[dd_8ass$stock_comparison==data_8ass[i,3] & dd_8ass$assess_order==max(dd_8ass[dd_8ass$stock_comparison==data_8ass[i,3],]$assess_order),]$method,
dd_8ass[dd_8ass$stock_comparison==data_8ass[i,3] & dd_8ass$assess_order==min(dd_8ass[dd_8ass$stock_comparison==data_8ass[i,3],]$assess_order),]$method,
sep="->")
}
## Put data together ##
data_full <- rbind(data_2ass, data_3ass, data_4ass, data_5ass, data_6ass, data_7ass, data_8ass)
## Data with 8 assessments ##
dd_8ass$stock_comparison <- paste(dd_8ass$stockid, dd_8ass$ty_order, sep="_")
data_8ass <- as.data.frame(matrix(NA, nrow=length(unique(dd_8ass$stock_comparison)), ncol=4))
colnames(data_8ass) <- c("stockid", "comparison", "stock_comparison", "MethodChange")
data_8ass$stock_comparison <- unique(dd_8ass$stock_comparison)
for (i in 1:length(unique(dd_8ass$stock_comparison))){
data_8ass[i,1] <- unique(dd_8ass[dd_8ass$stock_comparison==data_8ass[i,3],]$stockid)
data_8ass[i,2] <- unique(dd_8ass[dd_8ass$stock_comparison==data_8ass[i,3],]$ty_order)
data_8ass[i,4] <- paste(dd_8ass[dd_8ass$stock_comparison==data_8ass[i,3] & dd_8ass$assess_order==max(dd_8ass[dd_8ass$stock_comparison==data_8ass[i,3],]$assess_order),]$method,
dd_8ass[dd_8ass$stock_comparison==data_8ass[i,3] & dd_8ass$assess_order==min(dd_8ass[dd_8ass$stock_comparison==data_8ass[i,3],]$assess_order),]$method,
sep="->")
}
## Put data together ##
data_full <- rbind(data_2ass, data_3ass, data_4ass, data_5ass, data_6ass, data_7ass, data_8ass)
table(data_full$MethodChange)
table(data_full$MethodChange)
data_full$MethodChangeCode <- NA
key <- as.data.frame(table(data_full$MethodChange))
key$Var1
key_method_change <- as.data.frame(table(data_full$MethodChange))
write.csv(key_method_change, paste(outputdir, "1a_key_method_change.csv", sep="/"), row.names=F)
key_method_change <- read.csv("1a_key_method_change.csv")
setwd("~/Desktop/Climate_Stock/Bi_Code/B_F_OFL_dist/Data_preparation/output")
key_method_change <- read.csv("1a_key_method_change.csv")
key_method_change
summary(key_method_change)
key_method_change <- read.csv("1a_key_method_change.csv")
dd1a <- merge(data_full, key_method_change, by="MethodChange", all.x=TRUE)
dim(data_full)
dim(dd1a)
table(dd1a$Method)
head(ddd1)
head(dd1a)
## Put data together ##
data_full <- rbind(data_2ass, data_3ass, data_4ass, data_5ass, data_6ass, data_7ass, data_8ass)
key_method_change <- read.csv("1a_key_method_change.csv")
dd1a <- merge(data_full, key_method_change, by="MethodChange", all.x=TRUE)
head(ddd1a)
head(dd1a)
dd1a[dd1a$MethodChange=="Length-based",]
dd1a[dd1a$Method=="Length-based",]
key_method_change <- read.csv("1a_key_method_change.csv")
dd1a <- merge(data_full, key_method_change, by="MethodChange", all.x=TRUE)
data_full[is.na(data_full$MethodChangeCode),]$MethodChangeCode  # 0
table(dd1a$Method)
dd1a[dd1a$Method=="Length-based",]
table(dd1a$Method)
dd1a[dd1a$Method=="Index-based",]
dd1a[dd1a$Method=="Length-structured",]
dd1a[dd1a$Method=="Size-structured",]
table(dd1a$MethodChangeType)
dd1a[dd1a$Method=="Unknown" | dd1a$MethodChangeType=="Unknown",]
dd1a[(dd1a$Method=="Unknown" | dd1a$MethodChangeType=="Unknown") & dd1a$stockid=="FMEG8c9a",]$MethodChange
dd1a[dd1a$Method=="Unknown" | dd1a$MethodChangeType=="Unknown",]
dd1a[(dd1a$Method=="Unknown" | dd1a$MethodChangeType=="Unknown") & dd1a$stockid=="FMEG8c9a",]$MethodChange <-
"Age-based assessment (XSA)->Age-based assessment (XSA)"
dd1a[(dd1a$Method=="Unknown" | dd1a$MethodChangeType=="Unknown") & dd1a$stockid=="FMEG8c9a",]$Method <- "Age-structured"
dd1a[(dd1a$Method=="Unknown" | dd1a$MethodChangeType=="Unknown") & dd1a$stockid=="FMEG8c9a",]$MethodChangeType <- "Unchanged"
dd1a[dd1a$Method=="Unknown" | dd1a$MethodChangeType=="Unknown",]
dd1a[(dd1a$Method=="Unknown" | dd1a$MethodChangeType=="Unknown") & dd1a$stockid=="SNOWCRABBS",]$MethodChange <-
"Size-based biomass dynamics model->Size-based biomass dynamics model"
dd1a[(dd1a$Method=="Unknown" | dd1a$MethodChangeType=="Unknown") & dd1a$stockid=="SNOWCRABBS",]$Method <- "Length-based"
dd1a[(dd1a$Method=="Unknown" | dd1a$MethodChangeType=="Unknown") & dd1a$stockid=="SNOWCRABBS",]$MethodChangeType <- "Unchanged"
dd1a[(dd1a$Method=="Unknown" | dd1a$MethodChangeType=="Unknown") & dd1a$stockid=="TANNERCRABBSAI",]$MethodChange <-
"Size-based biomass dynamics model->Size-based biomass dynamics model"
dd1a[(dd1a$Method=="Unknown" | dd1a$MethodChangeType=="Unknown") & dd1a$stockid=="TANNERCRABBSAI",]$Method <- "Length-based"
dd1a[(dd1a$Method=="Unknown" | dd1a$MethodChangeType=="Unknown") & dd1a$stockid=="TANNERCRABBSAI",]$MethodChangeType <- "Unchanged"
dd1a[dd1a$Method=="Unknown" | dd1a$MethodChangeType=="Unknown",]
key_method_change <- read.csv("1a_key_method_change.csv")
dd1a <- merge(data_full, key_method_change, by="MethodChange", all.x=TRUE)
data_full[is.na(data_full$MethodChangeCode),]$MethodChangeCode  # 0
table(dd1a$Method)
dd1a[dd1a$Method=="Length-based",]
dd1a[dd1a$Method=="Index-based",]
dd1a[dd1a$Method=="Length-structured",]
dd1a[dd1a$Method=="Size-structured",]
table(dd1a$MethodChangeType)
dd1a[dd1a$Method=="Unknown" | dd1a$MethodChangeType=="Unknown",]
dd1a[(dd1a$Method=="Unknown" | dd1a$MethodChangeType=="Unknown") & dd1a$stockid=="FMEG8c9a",]$MethodChange <-
"Age-based assessment (XSA)->Age-based assessment (XSA)"
dd1a[(dd1a$Method=="Unknown" | dd1a$MethodChangeType=="Unknown") & dd1a$stockid=="FMEG8c9a",]$Method <- "Age-structured"
dd1a[(dd1a$Method=="Unknown" | dd1a$MethodChangeType=="Unknown") & dd1a$stockid=="FMEG8c9a",]$MethodChangeType <- "Unchanged"
dd1a[(dd1a$Method=="Unknown" | dd1a$MethodChangeType=="Unknown") & dd1a$stockid=="SNOWCRABBS",]$MethodChange <-
"Size-based biomass dynamics model->Size-based biomass dynamics model"
dd1a[(dd1a$Method=="Unknown" | dd1a$MethodChangeType=="Unknown") & dd1a$stockid=="SNOWCRABBS",]$Method <- "Length-based"
dd1a[(dd1a$Method=="Unknown" | dd1a$MethodChangeType=="Unknown") & dd1a$stockid=="SNOWCRABBS",]$MethodChangeType <- "Unchanged"
dd1a[(dd1a$Method=="Unknown" | dd1a$MethodChangeType=="Unknown") & dd1a$stockid=="TANNERCRABBSAI",]$MethodChange <-
"Size-based biomass dynamics model->Size-based biomass dynamics model"
dd1a[(dd1a$Method=="Unknown" | dd1a$MethodChangeType=="Unknown") & dd1a$stockid=="TANNERCRABBSAI",]$Method <- "Length-based"
dd1a[(dd1a$Method=="Unknown" | dd1a$MethodChangeType=="Unknown") & dd1a$stockid=="TANNERCRABBSAI",]$MethodChangeType <- "Unchanged"
dd1a[(dd1a$Method=="Unknown" | dd1a$MethodChangeType=="Unknown") & dd1a$stockid=="SBWHITACIR",]$MethodChange <-
"Integrated Analysis->Integrated Analysis"
dd1a[(dd1a$Method=="Unknown" | dd1a$MethodChangeType=="Unknown") & dd1a$stockid=="SBWHITACIR",]$MethodChangeType <- "Unchanged"
dd1a[(dd1a$Method=="Unknown" | dd1a$MethodChangeType=="Unknown") & dd1a$stockid=="COD4TVn",]$MethodChange <-
"Statistical catch at age model->Statistical catch at age model"
dd1a[(dd1a$Method=="Unknown" | dd1a$MethodChangeType=="Unknown") & dd1a$stockid=="COD4TVn",]$MethodChangeType <- "Unchanged"
dd1a[(dd1a$Method=="Unknown" | dd1a$MethodChangeType=="Unknown") & dd1a$stockid=="COD3Ps",]$MethodChange <-
"Survey index->Survey index"
dd1a[(dd1a$Method=="Unknown" | dd1a$MethodChangeType=="Unknown") & dd1a$stockid=="COD3Ps",]$MethodChangeType <- "Unchanged"
dd1a[(dd1a$Method=="Unknown" | dd1a$MethodChangeType=="Unknown") & dd1a$stockid=="MACKNWATLSA3-4",]$MethodChange <-
"Age-structured model->Age-structured model"
dd1a[(dd1a$Method=="Unknown" | dd1a$MethodChangeType=="Unknown") & dd1a$stockid=="MACKNWATLSA3-4",]$Method <- "Age-structured"
dd1a[(dd1a$Method=="Unknown" | dd1a$MethodChangeType=="Unknown") & dd1a$stockid=="MACKNWATLSA3-4",]$MethodChangeType <- "Unchanged"
dd1a[(dd1a$Method=="Unknown" | dd1a$MethodChangeType=="Unknown") & dd1a$stockid=="WHITVIIa",]$MethodChange <-
"Age-structured model->Age-structured model"
dd1a[(dd1a$Method=="Unknown" | dd1a$MethodChangeType=="Unknown") & dd1a$stockid=="WHITVIIa",]$Method <- "Age-structured"
dd1a[(dd1a$Method=="Unknown" | dd1a$MethodChangeType=="Unknown") & dd1a$stockid=="WHITVIIa",]$MethodChangeType <- "Unchanged"
dd1a[(dd1a$Method=="Unknown" | dd1a$MethodChangeType=="Unknown") & dd1a$stockid=="SAURNWPAC",]$MethodChange <-
"VPA->VPA"
dd1a[(dd1a$Method=="Unknown" | dd1a$MethodChangeType=="Unknown") & dd1a$stockid=="SAURNWPAC",]$Method <- "Age-structured"
dd1a[(dd1a$Method=="Unknown" | dd1a$MethodChangeType=="Unknown") & dd1a$stockid=="SAURNWPAC",]$MethodChangeType <- "Unchanged"
dd1a[dd1a$Method=="Unknown" | dd1a$MethodChangeType=="Unknown",]
write.csv(dd1a, paste(outputdir, "1a_data_method_change.csv", sep="/"), row.names=F)
