"Europe (EU)", "Europe (non-EU)",  "CA East Coast", "CA West Coast",
"Australia", "New Zealand", "Japan", "South Africa", "South America",
"AOHS", "IOHS", "POHS", "MBS"), time=7)
dd$para <- rep(c("B_ty", "Bmsy", "B_Bmsy", "F_ty", "Fmsy", "F_Fmsy", "OFL_ty"), each=20)
dat_B <- dat[!is.na(dat$B_recent) & !is.na(dat$B_old),]
dat_Bmsy <- dat[!is.na(dat$Bmsy_recent) & !is.na(dat$Bmsy_old),]
dat_B_Bmsy <- dat[!is.na(dat$B_by_Bmsy_recent) & !is.na(dat$B_by_Bmsy_old),]
dat_F <- dat[!is.na(dat$F_recent) & !is.na(dat$F_old),]
dat_Fmsy <- dat[!is.na(dat$Fmsy_recent) & !is.na(dat$Fmsy_old),]
dat_F_Fmsy <- dat[!is.na(dat$F_by_Fmsy_recent) & !is.na(dat$F_by_Fmsy_old),]
dat_OFL <- dat[!is.na(dat$OFL_ty_recent) & !is.na(dat$OFL_ty_old),]
# calculate average_interval
dd$average_interval <- c(ifelse(length(dat_B[dat_B$CouncilCode==1,]$interval)>0, mean(aggregate(dat_B[dat_B$CouncilCode==1,]$interval, list(dat_B[dat_B$CouncilCode==1,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_B[dat_B$CouncilCode==2,]$interval)>0, mean(aggregate(dat_B[dat_B$CouncilCode==2,]$interval, list(dat_B[dat_B$CouncilCode==2,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_B[dat_B$CouncilCode==3,]$interval)>0, mean(aggregate(dat_B[dat_B$CouncilCode==3,]$interval, list(dat_B[dat_B$CouncilCode==3,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_B[dat_B$CouncilCode==4,]$interval)>0, mean(aggregate(dat_B[dat_B$CouncilCode==4,]$interval, list(dat_B[dat_B$CouncilCode==4,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_B[dat_B$CouncilCode==5,]$interval)>0, mean(aggregate(dat_B[dat_B$CouncilCode==5,]$interval, list(dat_B[dat_B$CouncilCode==5,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_B[dat_B$CouncilCode==6,]$interval)>0, mean(aggregate(dat_B[dat_B$CouncilCode==6,]$interval, list(dat_B[dat_B$CouncilCode==6,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_B[dat_B$CouncilCode==7,]$interval)>0, mean(aggregate(dat_B[dat_B$CouncilCode==7,]$interval, list(dat_B[dat_B$CouncilCode==7,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_B[dat_B$CouncilCode==8,]$interval)>0, mean(aggregate(dat_B[dat_B$CouncilCode==8,]$interval, list(dat_B[dat_B$CouncilCode==8,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_B[dat_B$CouncilCode==9,]$interval)>0, mean(aggregate(dat_B[dat_B$CouncilCode==9,]$interval, list(dat_B[dat_B$CouncilCode==9,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_B[dat_B$CouncilCode==10,]$interval)>0, mean(aggregate(dat_B[dat_B$CouncilCode==10,]$interval, list(dat_B[dat_B$CouncilCode==10,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_B[dat_B$CouncilCode==11,]$interval)>0, mean(aggregate(dat_B[dat_B$CouncilCode==11,]$interval, list(dat_B[dat_B$CouncilCode==11,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_B[dat_B$CouncilCode==12,]$interval)>0, mean(aggregate(dat_B[dat_B$CouncilCode==12,]$interval, list(dat_B[dat_B$CouncilCode==12,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_B[dat_B$CouncilCode==13,]$interval)>0, mean(aggregate(dat_B[dat_B$CouncilCode==13,]$interval, list(dat_B[dat_B$CouncilCode==13,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_B[dat_B$CouncilCode==14,]$interval)>0, mean(aggregate(dat_B[dat_B$CouncilCode==14,]$interval, list(dat_B[dat_B$CouncilCode==14,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_B[dat_B$CouncilCode==15,]$interval)>0, mean(aggregate(dat_B[dat_B$CouncilCode==15,]$interval, list(dat_B[dat_B$CouncilCode==15,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_B[dat_B$CouncilCode==16,]$interval)>0, mean(aggregate(dat_B[dat_B$CouncilCode==16,]$interval, list(dat_B[dat_B$CouncilCode==16,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_B[dat_B$CouncilCode==17,]$interval)>0, mean(aggregate(dat_B[dat_B$CouncilCode==17,]$interval, list(dat_B[dat_B$CouncilCode==17,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_B[dat_B$CouncilCode==18,]$interval)>0, mean(aggregate(dat_B[dat_B$CouncilCode==18,]$interval, list(dat_B[dat_B$CouncilCode==18,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_B[dat_B$CouncilCode==19,]$interval)>0, mean(aggregate(dat_B[dat_B$CouncilCode==19,]$interval, list(dat_B[dat_B$CouncilCode==19,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_B[dat_B$CouncilCode==20,]$interval)>0, mean(aggregate(dat_B[dat_B$CouncilCode==20,]$interval, list(dat_B[dat_B$CouncilCode==20,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_Bmsy[dat_Bmsy$CouncilCode==1,]$interval)>0, mean(aggregate(dat_Bmsy[dat_Bmsy$CouncilCode==1,]$interval, list(dat_Bmsy[dat_Bmsy$CouncilCode==1,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_Bmsy[dat_Bmsy$CouncilCode==2,]$interval)>0, mean(aggregate(dat_Bmsy[dat_Bmsy$CouncilCode==2,]$interval, list(dat_Bmsy[dat_Bmsy$CouncilCode==2,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_Bmsy[dat_Bmsy$CouncilCode==3,]$interval)>0, mean(aggregate(dat_Bmsy[dat_Bmsy$CouncilCode==3,]$interval, list(dat_Bmsy[dat_Bmsy$CouncilCode==3,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_Bmsy[dat_Bmsy$CouncilCode==4,]$interval)>0, mean(aggregate(dat_Bmsy[dat_Bmsy$CouncilCode==4,]$interval, list(dat_Bmsy[dat_Bmsy$CouncilCode==4,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_Bmsy[dat_Bmsy$CouncilCode==5,]$interval)>0, mean(aggregate(dat_Bmsy[dat_Bmsy$CouncilCode==5,]$interval, list(dat_Bmsy[dat_Bmsy$CouncilCode==5,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_Bmsy[dat_Bmsy$CouncilCode==6,]$interval)>0, mean(aggregate(dat_Bmsy[dat_Bmsy$CouncilCode==6,]$interval, list(dat_Bmsy[dat_Bmsy$CouncilCode==6,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_Bmsy[dat_Bmsy$CouncilCode==7,]$interval)>0, mean(aggregate(dat_Bmsy[dat_Bmsy$CouncilCode==7,]$interval, list(dat_Bmsy[dat_Bmsy$CouncilCode==7,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_Bmsy[dat_Bmsy$CouncilCode==8,]$interval)>0, mean(aggregate(dat_Bmsy[dat_Bmsy$CouncilCode==8,]$interval, list(dat_Bmsy[dat_Bmsy$CouncilCode==8,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_Bmsy[dat_Bmsy$CouncilCode==9,]$interval)>0, mean(aggregate(dat_Bmsy[dat_Bmsy$CouncilCode==9,]$interval, list(dat_Bmsy[dat_Bmsy$CouncilCode==9,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_Bmsy[dat_Bmsy$CouncilCode==10,]$interval)>0, mean(aggregate(dat_Bmsy[dat_Bmsy$CouncilCode==10,]$interval, list(dat_Bmsy[dat_Bmsy$CouncilCode==10,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_Bmsy[dat_Bmsy$CouncilCode==11,]$interval)>0, mean(aggregate(dat_Bmsy[dat_Bmsy$CouncilCode==11,]$interval, list(dat_Bmsy[dat_Bmsy$CouncilCode==11,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_Bmsy[dat_Bmsy$CouncilCode==12,]$interval)>0, mean(aggregate(dat_Bmsy[dat_Bmsy$CouncilCode==12,]$interval, list(dat_Bmsy[dat_Bmsy$CouncilCode==12,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_Bmsy[dat_Bmsy$CouncilCode==13,]$interval)>0, mean(aggregate(dat_Bmsy[dat_Bmsy$CouncilCode==13,]$interval, list(dat_Bmsy[dat_Bmsy$CouncilCode==13,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_Bmsy[dat_Bmsy$CouncilCode==14,]$interval)>0, mean(aggregate(dat_Bmsy[dat_Bmsy$CouncilCode==14,]$interval, list(dat_Bmsy[dat_Bmsy$CouncilCode==14,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_Bmsy[dat_Bmsy$CouncilCode==15,]$interval)>0, mean(aggregate(dat_Bmsy[dat_Bmsy$CouncilCode==15,]$interval, list(dat_Bmsy[dat_Bmsy$CouncilCode==15,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_Bmsy[dat_Bmsy$CouncilCode==16,]$interval)>0, mean(aggregate(dat_Bmsy[dat_Bmsy$CouncilCode==16,]$interval, list(dat_Bmsy[dat_Bmsy$CouncilCode==16,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_Bmsy[dat_Bmsy$CouncilCode==17,]$interval)>0, mean(aggregate(dat_Bmsy[dat_Bmsy$CouncilCode==17,]$interval, list(dat_Bmsy[dat_Bmsy$CouncilCode==17,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_Bmsy[dat_Bmsy$CouncilCode==18,]$interval)>0, mean(aggregate(dat_Bmsy[dat_Bmsy$CouncilCode==18,]$interval, list(dat_Bmsy[dat_Bmsy$CouncilCode==18,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_Bmsy[dat_Bmsy$CouncilCode==19,]$interval)>0, mean(aggregate(dat_Bmsy[dat_Bmsy$CouncilCode==19,]$interval, list(dat_Bmsy[dat_Bmsy$CouncilCode==19,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_Bmsy[dat_Bmsy$CouncilCode==20,]$interval)>0, mean(aggregate(dat_Bmsy[dat_Bmsy$CouncilCode==20,]$interval, list(dat_Bmsy[dat_Bmsy$CouncilCode==20,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==1,]$interval)>0, mean(aggregate(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==1,]$interval, list(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==1,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==2,]$interval)>0, mean(aggregate(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==2,]$interval, list(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==2,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==3,]$interval)>0, mean(aggregate(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==3,]$interval, list(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==3,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==4,]$interval)>0, mean(aggregate(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==4,]$interval, list(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==4,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==5,]$interval)>0, mean(aggregate(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==5,]$interval, list(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==5,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==6,]$interval)>0, mean(aggregate(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==6,]$interval, list(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==6,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==7,]$interval)>0, mean(aggregate(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==7,]$interval, list(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==7,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==8,]$interval)>0, mean(aggregate(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==8,]$interval, list(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==8,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==9,]$interval)>0, mean(aggregate(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==9,]$interval, list(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==9,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==10,]$interval)>0, mean(aggregate(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==10,]$interval, list(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==10,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==11,]$interval)>0, mean(aggregate(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==11,]$interval, list(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==11,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==12,]$interval)>0, mean(aggregate(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==12,]$interval, list(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==12,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==13,]$interval)>0, mean(aggregate(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==13,]$interval, list(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==13,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==14,]$interval)>0, mean(aggregate(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==14,]$interval, list(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==14,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==15,]$interval)>0, mean(aggregate(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==15,]$interval, list(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==15,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==16,]$interval)>0, mean(aggregate(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==16,]$interval, list(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==16,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==17,]$interval)>0, mean(aggregate(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==17,]$interval, list(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==17,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==18,]$interval)>0, mean(aggregate(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==18,]$interval, list(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==18,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==19,]$interval)>0, mean(aggregate(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==19,]$interval, list(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==19,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==20,]$interval)>0, mean(aggregate(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==20,]$interval, list(dat_B_Bmsy[dat_B_Bmsy$CouncilCode==20,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_F[dat_F$CouncilCode==1,]$interval)>0, mean(aggregate(dat_F[dat_F$CouncilCode==1,]$interval, list(dat_F[dat_F$CouncilCode==1,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_F[dat_F$CouncilCode==2,]$interval)>0, mean(aggregate(dat_F[dat_F$CouncilCode==2,]$interval, list(dat_F[dat_F$CouncilCode==2,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_F[dat_F$CouncilCode==3,]$interval)>0, mean(aggregate(dat_F[dat_F$CouncilCode==3,]$interval, list(dat_F[dat_F$CouncilCode==3,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_F[dat_F$CouncilCode==4,]$interval)>0, mean(aggregate(dat_F[dat_F$CouncilCode==4,]$interval, list(dat_F[dat_F$CouncilCode==4,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_F[dat_F$CouncilCode==5,]$interval)>0, mean(aggregate(dat_F[dat_F$CouncilCode==5,]$interval, list(dat_F[dat_F$CouncilCode==5,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_F[dat_F$CouncilCode==6,]$interval)>0, mean(aggregate(dat_F[dat_F$CouncilCode==6,]$interval, list(dat_F[dat_F$CouncilCode==6,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_F[dat_F$CouncilCode==7,]$interval)>0, mean(aggregate(dat_F[dat_F$CouncilCode==7,]$interval, list(dat_F[dat_F$CouncilCode==7,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_F[dat_F$CouncilCode==8,]$interval)>0, mean(aggregate(dat_F[dat_F$CouncilCode==8,]$interval, list(dat_F[dat_F$CouncilCode==8,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_F[dat_F$CouncilCode==9,]$interval)>0, mean(aggregate(dat_F[dat_F$CouncilCode==9,]$interval, list(dat_F[dat_F$CouncilCode==9,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_F[dat_F$CouncilCode==10,]$interval)>0, mean(aggregate(dat_F[dat_F$CouncilCode==10,]$interval, list(dat_F[dat_F$CouncilCode==10,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_F[dat_F$CouncilCode==11,]$interval)>0, mean(aggregate(dat_F[dat_F$CouncilCode==11,]$interval, list(dat_F[dat_F$CouncilCode==11,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_F[dat_F$CouncilCode==12,]$interval)>0, mean(aggregate(dat_F[dat_F$CouncilCode==12,]$interval, list(dat_F[dat_F$CouncilCode==12,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_F[dat_F$CouncilCode==13,]$interval)>0, mean(aggregate(dat_F[dat_F$CouncilCode==13,]$interval, list(dat_F[dat_F$CouncilCode==13,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_F[dat_F$CouncilCode==14,]$interval)>0, mean(aggregate(dat_F[dat_F$CouncilCode==14,]$interval, list(dat_F[dat_F$CouncilCode==14,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_F[dat_F$CouncilCode==15,]$interval)>0, mean(aggregate(dat_F[dat_F$CouncilCode==15,]$interval, list(dat_F[dat_F$CouncilCode==15,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_F[dat_F$CouncilCode==16,]$interval)>0, mean(aggregate(dat_F[dat_F$CouncilCode==16,]$interval, list(dat_F[dat_F$CouncilCode==16,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_F[dat_F$CouncilCode==17,]$interval)>0, mean(aggregate(dat_F[dat_F$CouncilCode==17,]$interval, list(dat_F[dat_F$CouncilCode==17,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_F[dat_F$CouncilCode==18,]$interval)>0, mean(aggregate(dat_F[dat_F$CouncilCode==18,]$interval, list(dat_F[dat_F$CouncilCode==18,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_F[dat_F$CouncilCode==19,]$interval)>0, mean(aggregate(dat_F[dat_F$CouncilCode==19,]$interval, list(dat_F[dat_F$CouncilCode==19,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_F[dat_F$CouncilCode==20,]$interval)>0, mean(aggregate(dat_F[dat_F$CouncilCode==20,]$interval, list(dat_F[dat_F$CouncilCode==20,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_Fmsy[dat_Fmsy$CouncilCode==1,]$interval)>0, mean(aggregate(dat_Fmsy[dat_Fmsy$CouncilCode==1,]$interval, list(dat_Fmsy[dat_Fmsy$CouncilCode==1,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_Fmsy[dat_Fmsy$CouncilCode==2,]$interval)>0, mean(aggregate(dat_Fmsy[dat_Fmsy$CouncilCode==2,]$interval, list(dat_Fmsy[dat_Fmsy$CouncilCode==2,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_Fmsy[dat_Fmsy$CouncilCode==3,]$interval)>0, mean(aggregate(dat_Fmsy[dat_Fmsy$CouncilCode==3,]$interval, list(dat_Fmsy[dat_Fmsy$CouncilCode==3,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_Fmsy[dat_Fmsy$CouncilCode==4,]$interval)>0, mean(aggregate(dat_Fmsy[dat_Fmsy$CouncilCode==4,]$interval, list(dat_Fmsy[dat_Fmsy$CouncilCode==4,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_Fmsy[dat_Fmsy$CouncilCode==5,]$interval)>0, mean(aggregate(dat_Fmsy[dat_Fmsy$CouncilCode==5,]$interval, list(dat_Fmsy[dat_Fmsy$CouncilCode==5,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_Fmsy[dat_Fmsy$CouncilCode==6,]$interval)>0, mean(aggregate(dat_Fmsy[dat_Fmsy$CouncilCode==6,]$interval, list(dat_Fmsy[dat_Fmsy$CouncilCode==6,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_Fmsy[dat_Fmsy$CouncilCode==7,]$interval)>0, mean(aggregate(dat_Fmsy[dat_Fmsy$CouncilCode==7,]$interval, list(dat_Fmsy[dat_Fmsy$CouncilCode==7,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_Fmsy[dat_Fmsy$CouncilCode==8,]$interval)>0, mean(aggregate(dat_Fmsy[dat_Fmsy$CouncilCode==8,]$interval, list(dat_Fmsy[dat_Fmsy$CouncilCode==8,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_Fmsy[dat_Fmsy$CouncilCode==9,]$interval)>0, mean(aggregate(dat_Fmsy[dat_Fmsy$CouncilCode==9,]$interval, list(dat_Fmsy[dat_Fmsy$CouncilCode==9,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_Fmsy[dat_Fmsy$CouncilCode==10,]$interval)>0, mean(aggregate(dat_Fmsy[dat_Fmsy$CouncilCode==10,]$interval, list(dat_Fmsy[dat_Fmsy$CouncilCode==10,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_Fmsy[dat_Fmsy$CouncilCode==11,]$interval)>0, mean(aggregate(dat_Fmsy[dat_Fmsy$CouncilCode==11,]$interval, list(dat_Fmsy[dat_Fmsy$CouncilCode==11,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_Fmsy[dat_Fmsy$CouncilCode==12,]$interval)>0, mean(aggregate(dat_Fmsy[dat_Fmsy$CouncilCode==12,]$interval, list(dat_Fmsy[dat_Fmsy$CouncilCode==12,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_Fmsy[dat_Fmsy$CouncilCode==13,]$interval)>0, mean(aggregate(dat_Fmsy[dat_Fmsy$CouncilCode==13,]$interval, list(dat_Fmsy[dat_Fmsy$CouncilCode==13,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_Fmsy[dat_Fmsy$CouncilCode==14,]$interval)>0, mean(aggregate(dat_Fmsy[dat_Fmsy$CouncilCode==14,]$interval, list(dat_Fmsy[dat_Fmsy$CouncilCode==14,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_Fmsy[dat_Fmsy$CouncilCode==15,]$interval)>0, mean(aggregate(dat_Fmsy[dat_Fmsy$CouncilCode==15,]$interval, list(dat_Fmsy[dat_Fmsy$CouncilCode==15,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_Fmsy[dat_Fmsy$CouncilCode==16,]$interval)>0, mean(aggregate(dat_Fmsy[dat_Fmsy$CouncilCode==16,]$interval, list(dat_Fmsy[dat_Fmsy$CouncilCode==16,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_Fmsy[dat_Fmsy$CouncilCode==17,]$interval)>0, mean(aggregate(dat_Fmsy[dat_Fmsy$CouncilCode==17,]$interval, list(dat_Fmsy[dat_Fmsy$CouncilCode==17,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_Fmsy[dat_Fmsy$CouncilCode==18,]$interval)>0, mean(aggregate(dat_Fmsy[dat_Fmsy$CouncilCode==18,]$interval, list(dat_Fmsy[dat_Fmsy$CouncilCode==18,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_Fmsy[dat_Fmsy$CouncilCode==19,]$interval)>0, mean(aggregate(dat_Fmsy[dat_Fmsy$CouncilCode==19,]$interval, list(dat_Fmsy[dat_Fmsy$CouncilCode==19,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_Fmsy[dat_Fmsy$CouncilCode==20,]$interval)>0, mean(aggregate(dat_Fmsy[dat_Fmsy$CouncilCode==20,]$interval, list(dat_Fmsy[dat_Fmsy$CouncilCode==20,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==1,]$interval)>0, mean(aggregate(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==1,]$interval, list(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==1,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==2,]$interval)>0, mean(aggregate(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==2,]$interval, list(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==2,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==3,]$interval)>0, mean(aggregate(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==3,]$interval, list(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==3,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==4,]$interval)>0, mean(aggregate(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==4,]$interval, list(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==4,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==5,]$interval)>0, mean(aggregate(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==5,]$interval, list(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==5,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==6,]$interval)>0, mean(aggregate(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==6,]$interval, list(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==6,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==7,]$interval)>0, mean(aggregate(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==7,]$interval, list(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==7,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==8,]$interval)>0, mean(aggregate(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==8,]$interval, list(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==8,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==9,]$interval)>0, mean(aggregate(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==9,]$interval, list(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==9,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==10,]$interval)>0, mean(aggregate(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==10,]$interval, list(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==10,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==11,]$interval)>0, mean(aggregate(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==11,]$interval, list(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==11,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==12,]$interval)>0, mean(aggregate(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==12,]$interval, list(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==12,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==13,]$interval)>0, mean(aggregate(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==13,]$interval, list(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==13,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==14,]$interval)>0, mean(aggregate(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==14,]$interval, list(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==14,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==15,]$interval)>0, mean(aggregate(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==15,]$interval, list(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==15,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==16,]$interval)>0, mean(aggregate(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==16,]$interval, list(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==16,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==17,]$interval)>0, mean(aggregate(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==17,]$interval, list(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==17,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==18,]$interval)>0, mean(aggregate(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==18,]$interval, list(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==18,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==19,]$interval)>0, mean(aggregate(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==19,]$interval, list(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==19,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==20,]$interval)>0, mean(aggregate(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==20,]$interval, list(dat_F_Fmsy[dat_F_Fmsy$CouncilCode==20,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_OFL[dat_OFL$CouncilCode==1,]$interval)>0, mean(aggregate(dat_OFL[dat_OFL$CouncilCode==1,]$interval, list(dat_OFL[dat_OFL$CouncilCode==1,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_OFL[dat_OFL$CouncilCode==2,]$interval)>0, mean(aggregate(dat_OFL[dat_OFL$CouncilCode==2,]$interval, list(dat_OFL[dat_OFL$CouncilCode==2,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_OFL[dat_OFL$CouncilCode==3,]$interval)>0, mean(aggregate(dat_OFL[dat_OFL$CouncilCode==3,]$interval, list(dat_OFL[dat_OFL$CouncilCode==3,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_OFL[dat_OFL$CouncilCode==4,]$interval)>0, mean(aggregate(dat_OFL[dat_OFL$CouncilCode==4,]$interval, list(dat_OFL[dat_OFL$CouncilCode==4,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_OFL[dat_OFL$CouncilCode==5,]$interval)>0, mean(aggregate(dat_OFL[dat_OFL$CouncilCode==5,]$interval, list(dat_OFL[dat_OFL$CouncilCode==5,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_OFL[dat_OFL$CouncilCode==6,]$interval)>0, mean(aggregate(dat_OFL[dat_OFL$CouncilCode==6,]$interval, list(dat_OFL[dat_OFL$CouncilCode==6,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_OFL[dat_OFL$CouncilCode==7,]$interval)>0, mean(aggregate(dat_OFL[dat_OFL$CouncilCode==7,]$interval, list(dat_OFL[dat_OFL$CouncilCode==7,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_OFL[dat_OFL$CouncilCode==8,]$interval)>0, mean(aggregate(dat_OFL[dat_OFL$CouncilCode==8,]$interval, list(dat_OFL[dat_OFL$CouncilCode==8,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_OFL[dat_OFL$CouncilCode==9,]$interval)>0, mean(aggregate(dat_OFL[dat_OFL$CouncilCode==9,]$interval, list(dat_OFL[dat_OFL$CouncilCode==9,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_OFL[dat_OFL$CouncilCode==10,]$interval)>0, mean(aggregate(dat_OFL[dat_OFL$CouncilCode==10,]$interval, list(dat_OFL[dat_OFL$CouncilCode==10,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_OFL[dat_OFL$CouncilCode==11,]$interval)>0, mean(aggregate(dat_OFL[dat_OFL$CouncilCode==11,]$interval, list(dat_OFL[dat_OFL$CouncilCode==11,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_OFL[dat_OFL$CouncilCode==12,]$interval)>0, mean(aggregate(dat_OFL[dat_OFL$CouncilCode==12,]$interval, list(dat_OFL[dat_OFL$CouncilCode==12,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_OFL[dat_OFL$CouncilCode==13,]$interval)>0, mean(aggregate(dat_OFL[dat_OFL$CouncilCode==13,]$interval, list(dat_OFL[dat_OFL$CouncilCode==13,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_OFL[dat_OFL$CouncilCode==14,]$interval)>0, mean(aggregate(dat_OFL[dat_OFL$CouncilCode==14,]$interval, list(dat_OFL[dat_OFL$CouncilCode==14,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_OFL[dat_OFL$CouncilCode==15,]$interval)>0, mean(aggregate(dat_OFL[dat_OFL$CouncilCode==15,]$interval, list(dat_OFL[dat_OFL$CouncilCode==15,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_OFL[dat_OFL$CouncilCode==16,]$interval)>0, mean(aggregate(dat_OFL[dat_OFL$CouncilCode==16,]$interval, list(dat_OFL[dat_OFL$CouncilCode==16,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_OFL[dat_OFL$CouncilCode==17,]$interval)>0, mean(aggregate(dat_OFL[dat_OFL$CouncilCode==17,]$interval, list(dat_OFL[dat_OFL$CouncilCode==17,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_OFL[dat_OFL$CouncilCode==18,]$interval)>0, mean(aggregate(dat_OFL[dat_OFL$CouncilCode==18,]$interval, list(dat_OFL[dat_OFL$CouncilCode==18,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_OFL[dat_OFL$CouncilCode==19,]$interval)>0, mean(aggregate(dat_OFL[dat_OFL$CouncilCode==19,]$interval, list(dat_OFL[dat_OFL$CouncilCode==19,]$stockid), FUN=mean)$x), NA),
ifelse(length(dat_OFL[dat_OFL$CouncilCode==20,]$interval)>0, mean(aggregate(dat_OFL[dat_OFL$CouncilCode==20,]$interval, list(dat_OFL[dat_OFL$CouncilCode==20,]$stockid), FUN=mean)$x), NA))
# read results
load("dd_B.RData")
res_B <- aggregate(dd_B$value, list(dd_B$Region, dd_B$Period), FUN=median)
colnames(res_B) <- c("region", "period", "cv")
res_B_long <- res_B[res_B$period=="Long", c(1,3)]; colnames(res_B_long)[2] <- "cv_long"
res_B_short <- res_B[res_B$period=="Short", c(1,3)]; colnames(res_B_short)[2] <- "cv_short"
res_B <- merge(res_B_long, res_B_short, by="region")
res_B$para <- "B_ty"
load("dd_Bmsy.RData")
res_Bmsy <- aggregate(dd_Bmsy$value, list(dd_Bmsy$Region, dd_Bmsy$Period), FUN=median)
colnames(res_Bmsy) <- c("region", "period", "cv")
res_Bmsy_long <- res_Bmsy[res_Bmsy$period=="Long", c(1,3)]; colnames(res_Bmsy_long)[2] <- "cv_long"
res_Bmsy_short <- res_Bmsy[res_Bmsy$period=="Short", c(1,3)]; colnames(res_Bmsy_short)[2] <- "cv_short"
res_Bmsy <- merge(res_Bmsy_long, res_Bmsy_short, by="region")
res_Bmsy$para <- "Bmsy"
load("dd_B_Bmsy.RData")
res_B_Bmsy <- aggregate(dd_B_Bmsy$value, list(dd_B_Bmsy$Region, dd_B_Bmsy$Period), FUN=median)
colnames(res_B_Bmsy) <- c("region", "period", "cv")
res_B_Bmsy_long <- res_B_Bmsy[res_B_Bmsy$period=="Long", c(1,3)]; colnames(res_B_Bmsy_long)[2] <- "cv_long"
res_B_Bmsy_short <- res_B_Bmsy[res_B_Bmsy$period=="Short", c(1,3)]; colnames(res_B_Bmsy_short)[2] <- "cv_short"
res_B_Bmsy <- merge(res_B_Bmsy_long, res_B_Bmsy_short, by="region")
res_B_Bmsy$para <- "B_Bmsy"
load("dd_F.RData")
res_F <- aggregate(dd_F$value, list(dd_F$Region, dd_F$Period), FUN=median)
colnames(res_F) <- c("region", "period", "cv")
res_F_long <- res_F[res_F$period=="Long", c(1,3)]; colnames(res_F_long)[2] <- "cv_long"
res_F_short <- res_F[res_F$period=="Short", c(1,3)]; colnames(res_F_short)[2] <- "cv_short"
res_F <- merge(res_F_long, res_F_short, by="region")
res_F$para <- "F_ty"
load("dd_Fmsy.RData")
res_Fmsy <- aggregate(dd_Fmsy$value, list(dd_Fmsy$Region, dd_Fmsy$Period), FUN=median)
colnames(res_Fmsy) <- c("region", "period", "cv")
res_Fmsy_long <- res_Fmsy[res_Fmsy$period=="Long", c(1,3)]; colnames(res_Fmsy_long)[2] <- "cv_long"
res_Fmsy_short <- res_Fmsy[res_Fmsy$period=="Short", c(1,3)]; colnames(res_Fmsy_short)[2] <- "cv_short"
res_Fmsy <- merge(res_Fmsy_long, res_Fmsy_short, by="region")
res_Fmsy$para <- "Fmsy"
load("dd_F_Fmsy.RData")
res_F_Fmsy <- aggregate(dd_F_Fmsy$value, list(dd_F_Fmsy$Region, dd_F_Fmsy$Period), FUN=median)
colnames(res_F_Fmsy) <- c("region", "period", "cv")
res_F_Fmsy_long <- res_F_Fmsy[res_F_Fmsy$period=="Long", c(1,3)]; colnames(res_F_Fmsy_long)[2] <- "cv_long"
res_F_Fmsy_short <- res_F_Fmsy[res_F_Fmsy$period=="Short", c(1,3)]; colnames(res_F_Fmsy_short)[2] <- "cv_short"
res_F_Fmsy <- merge(res_F_Fmsy_long, res_F_Fmsy_short, by="region")
res_F_Fmsy$para <- "F_Fmsy"
load("dd_OFL.RData")
res_OFL <- aggregate(dd_OFL$value, list(dd_OFL$Region, dd_OFL$Period), FUN=median)
colnames(res_OFL) <- c("region", "period", "cv")
res_OFL_long <- res_OFL[res_OFL$period=="Long", c(1,3)]; colnames(res_OFL_long)[2] <- "cv_long"
res_OFL_short <- res_OFL[res_OFL$period=="Short", c(1,3)]; colnames(res_OFL_short)[2] <- "cv_short"
res_OFL <- merge(res_OFL_long, res_OFL_short, by="region")
res_OFL$para <- "OFL_ty"
res <- rbind(res_B, res_Bmsy, res_B_Bmsy, res_F, res_Fmsy, res_F_Fmsy, res_OFL)
res$key <- paste(res$region, res$para, sep="_")
dd$key <- paste(dd$region, dd$para, sep="_")
dd_cv <- merge(dd, res[,c(5,2,3)], by="key")
summary(dd_cv)
dd_cv[is.na(dd_cv$average_interval),]$cv_long <- NA
dd_cv[is.na(dd_cv$average_interval),]$cv_short <- NA
dd_cv$region <- factor(dd_cv$region, levels = c("GMFMC", "MAFMC", "NEFMC", "NPFMC", "PFMC", "SAFMC", "US non-federal",
"Europe (EU)", "Europe (non-EU)",  "CA East Coast", "CA West Coast",
"Australia", "New Zealand", "Japan", "South Africa", "South America",
"AOHS", "IOHS", "POHS", "MBS"))
dd_cv$para <- factor(dd_cv$para, levels=c("B_ty", "F_ty","Bmsy", "Fmsy","B_Bmsy",   "F_Fmsy", "OFL_ty"))
dd_cv$group <- factor(dd_cv$para, labels=c(expression(bolditalic(B[ty])), expression(bolditalic(F[ty])),
expression(bolditalic(B[MSY])), expression(bolditalic(F[MSY])),
expression(bolditalic(B[ty]/B[MSY])),
expression(bolditalic(F[ty]/F[MSY])),
expression(bolditalic(OFL[ty]))))
library(ggplot2)
library(ggpmisc)
cbPalette1 <- c(1:20)
cbPalette2 <- c("#CC79A7", "#0072B2")
dd_cv_long <- dd_cv[,c(2,4,5,3,7)]; colnames(dd_cv_long)[3] <- "cv"; dd_cv_long$type <- "CV_long"
dd_cv_short <- dd_cv[,c(2,4,6,3,7)]; colnames(dd_cv_short)[3] <- "cv"; dd_cv_short$type <- "CV_short"
dd <- rbind(dd_cv_long, dd_cv_short)
dd$type <- factor(dd$type, levels=c("CV_long", "CV_short"))
dd$region <- factor(dd$region, levels = c("GMFMC", "MAFMC", "NEFMC", "NPFMC", "PFMC", "SAFMC", "US non-federal",
"Europe (EU)", "Europe (non-EU)",  "CA East Coast", "CA West Coast",
"Australia", "New Zealand", "Japan", "South Africa", "South America",
"AOHS", "IOHS", "POHS", "MBS"))
p1 <- ggplot(data=dd, aes(x=average_interval, y=cv, colour=type)) +
geom_point(aes(shape=region), size = 3, stroke = 1.5) +
stat_poly_line(size=1.1) +
#stat_poly_eq(aes(label = paste(after_stat(eq.label), after_stat(rr.label), after_stat(p.value.label), sep = "*\", \"*")), size=5, vjust=1.58, hjust=0.05) +
stat_poly_eq(aes(label = paste(after_stat(eq.label), after_stat(rr.label), sep = "*\", \"*")), size=5, vjust=1.7, hjust=0.05) +
scale_colour_manual(name = "Type", values=cbPalette2, labels = expression(CV[long], CV[short])) +
scale_shape_manual(name = "Region", values=cbPalette1, labels = c("GMFMC", "MAFMC", "NEFMC", "NPFMC", "PFMC", "SAFMC", "US non-federal",
"Europe (EU)", "Europe (non-EU)",  "CA East Coast", "CA West Coast",
"Australia", "New Zealand", "Japan", "South Africa", "South America",
"AOHS", "IOHS", "POHS", "MBS")) +
facet_wrap(~group, labeller = label_parsed, scales = "free", strip.position = "top", nrow = 2, dir = "v") +
xlab("Average assessment frequency (year)") +
ylab("CV (%)") +
theme_bw() +
theme(panel.border = element_rect(colour = "black", fill=NA, size=1),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black"),
axis.text.y   = element_text(size=20),
axis.text.x   = element_text(size=20),
axis.title.y  = element_text(size=22),
axis.title.x  = element_text(size=22),
legend.title = element_text(size=22),
legend.text = element_text(size=20),
legend.position = "none",
legend.box="vertical",
legend.margin=margin(40,0,0,0),
legend.spacing.y = unit(0.8, "lines"),
strip.text.x = element_text(size=22, face = "bold"),
strip.text.y = element_text(size=22, face = "bold"),
plot.margin = unit(c(0.5,0.5,0.5,0.5), "lines"))
png("Frequency.png", height = 8, width = 16, units='in', res=600)
p1
dev.off()
p1 <- ggplot(data=dd, aes(x=average_interval, y=cv, colour=type)) +
geom_point(aes(shape=region), size = 3, stroke = 1.5) +
stat_poly_line(size=1.1) +
#stat_poly_eq(aes(label = paste(after_stat(eq.label), after_stat(rr.label), after_stat(p.value.label), sep = "*\", \"*")), size=5, vjust=1.58, hjust=0.05) +
stat_poly_eq(aes(label = paste(after_stat(eq.label), after_stat(rr.label), sep = "*\", \"*")), size=4, vjust=1.7, hjust=0.05) +
scale_colour_manual(name = "Type", values=cbPalette2, labels = expression(CV[long], CV[short])) +
scale_shape_manual(name = "Region", values=cbPalette1, labels = c("GMFMC", "MAFMC", "NEFMC", "NPFMC", "PFMC", "SAFMC", "US non-federal",
"Europe (EU)", "Europe (non-EU)",  "CA East Coast", "CA West Coast",
"Australia", "New Zealand", "Japan", "South Africa", "South America",
"AOHS", "IOHS", "POHS", "MBS")) +
facet_wrap(~group, labeller = label_parsed, scales = "free", strip.position = "top", nrow = 2, dir = "v") +
xlab("Average assessment frequency (year)") +
ylab("CV (%)") +
theme_bw() +
theme(panel.border = element_rect(colour = "black", fill=NA, size=1),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black"),
axis.text.y   = element_text(size=20),
axis.text.x   = element_text(size=20),
axis.title.y  = element_text(size=22),
axis.title.x  = element_text(size=22),
legend.title = element_text(size=22),
legend.text = element_text(size=20),
legend.position = "none",
legend.box="vertical",
legend.margin=margin(40,0,0,0),
legend.spacing.y = unit(0.8, "lines"),
strip.text.x = element_text(size=22, face = "bold"),
strip.text.y = element_text(size=22, face = "bold"),
plot.margin = unit(c(0.5,0.5,0.5,0.5), "lines"))
png("Frequency.png", height = 8, width = 16, units='in', res=600)
p1
dev.off()
png("Frequency.png", height = 8, width = 16, units='in', res=300)
p1
dev.off()
p1 <- ggplot(data=dd, aes(x=average_interval, y=cv, colour=type)) +
geom_point(aes(shape=region), size = 3, stroke = 1.5) +
stat_poly_line(size=1.1) +
#stat_poly_eq(aes(label = paste(after_stat(eq.label), after_stat(rr.label), after_stat(p.value.label), sep = "*\", \"*")), size=5, vjust=1.58, hjust=0.05) +
stat_poly_eq(aes(label = paste(after_stat(eq.label), after_stat(rr.label), sep = "*\", \"*")), size=3.5, vjust=1.7, hjust=0.05) +
scale_colour_manual(name = "Type", values=cbPalette2, labels = expression(CV[long], CV[short])) +
scale_shape_manual(name = "Region", values=cbPalette1, labels = c("GMFMC", "MAFMC", "NEFMC", "NPFMC", "PFMC", "SAFMC", "US non-federal",
"Europe (EU)", "Europe (non-EU)",  "CA East Coast", "CA West Coast",
"Australia", "New Zealand", "Japan", "South Africa", "South America",
"AOHS", "IOHS", "POHS", "MBS")) +
facet_wrap(~group, labeller = label_parsed, scales = "free", strip.position = "top", nrow = 2, dir = "v") +
xlab("Average assessment frequency (year)") +
ylab("CV (%)") +
theme_bw() +
theme(panel.border = element_rect(colour = "black", fill=NA, size=1),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black"),
axis.text.y   = element_text(size=20),
axis.text.x   = element_text(size=20),
axis.title.y  = element_text(size=22),
axis.title.x  = element_text(size=22),
legend.title = element_text(size=22),
legend.text = element_text(size=20),
legend.position = "none",
legend.box="vertical",
legend.margin=margin(40,0,0,0),
legend.spacing.y = unit(0.8, "lines"),
strip.text.x = element_text(size=22, face = "bold"),
strip.text.y = element_text(size=22, face = "bold"),
plot.margin = unit(c(0.5,0.5,0.5,0.5), "lines"))
png("Frequency.png", height = 8, width = 16, units='in', res=300)
p1
dev.off()
stock <- read.csv("277stocks_countries.csv")
dim(stock)  # 277
lme <- read.csv("stockid_lme.csv")
dim(lme)
library(dplyr)
lme_clean <- distinct(lme[,c(1,2)], stockid, .keep_all = TRUE)
dim(lme_clean)
dd <- merge(stock, lme_clean, by="stockid", all.x=TRUE)
dim(dd)
summary(dd)
check <- dd[is.na(dd$lme_number),]
areaid <- unique(check$area)
# ICES stock location: https://standardgraphs.ices.dk/stockList.aspx
dd[!is.na(dd$area) & dd$area==areaid[1],]$lme_number <- 62
dd[!is.na(dd$area) & dd$area==areaid[2],]$lme_number <- 62
dd[is.na(dd$area) & dd$stockid=="atmackerel",]$area <- "Gulf of Maine / Georges Bank"
dd[dd$stockid=="atmackerel",]$lme_number <- 7
dd[is.na(dd$area),]$lme_number <- 6
dd[!is.na(dd$area) & dd$area==areaid[4],]$lme_number <- 42
dd[!is.na(dd$area) & dd$area==areaid[5],]$lme_number <- -99
dd[!is.na(dd$area) & dd$area==areaid[6],]$lme_number <- 24
dd[!is.na(dd$area) & dd$area==areaid[7],]$lme_number <- 5
dd[!is.na(dd$area) & dd$area==areaid[8],]$lme_number <- NA
dd[!is.na(dd$area) & dd$area==areaid[9],]$lme_number <- 22
dd[!is.na(dd$area) & dd$area==areaid[10],]$lme_number <- 21
dd[!is.na(dd$area) & dd$area==areaid[11],]$lme_number <- 24
dd[!is.na(dd$area) & dd$area==areaid[12],]$lme_number <- 59
dd[!is.na(dd$area) & dd$area==areaid[13],]$lme_number <- 24
dd[!is.na(dd$area) & dd$area==areaid[14],]$lme_number <- 59
dd[!is.na(dd$area) & dd$area==areaid[15],]$lme_number <- 22
dd[!is.na(dd$area) & dd$area==areaid[16],]$lme_number <- 23
dd[!is.na(dd$area) & dd$area==areaid[17],]$lme_number <- 23
dd[!is.na(dd$area) & dd$area==areaid[18],]$lme_number <- 24
dd[!is.na(dd$area) & dd$area==areaid[19],]$lme_number <- 22
dd[!is.na(dd$area) & dd$area==areaid[20],]$lme_number <- 24
dd[!is.na(dd$area) & dd$area==areaid[21],]$lme_number <- 24
dd[!is.na(dd$area) & dd$area==areaid[22],]$lme_number <- 25
dd[!is.na(dd$area) & dd$area==areaid[23],]$lme_number <- 50
dd[!is.na(dd$area) & dd$area==areaid[24],]$lme_number <- 59
dd[!is.na(dd$area) & dd$area==areaid[25],]$lme_number <- 9
dd[!is.na(dd$area) & dd$area==areaid[26],]$lme_number <- 24
dd[!is.na(dd$area) & dd$area==areaid[27],]$lme_number <- 42
dd[!is.na(dd$area) & dd$area==areaid[28],]$lme_number <- 43
dd[!is.na(dd$area) & dd$area==areaid[29],]$lme_number <- 26
dd[!is.na(dd$area) & dd$area==areaid[30],]$lme_number <- 26
dd[!is.na(dd$area) & dd$area==areaid[31],]$lme_number <- 22
dd[!is.na(dd$area) & dd$area==areaid[32],]$lme_number <- 47
dd[!is.na(dd$area) & dd$area==areaid[33],]$lme_number <- 50
dd[!is.na(dd$area) & dd$area==areaid[34] & dd$council=="Japan",]$lme_number <- NA
dd[!is.na(dd$area) & dd$area==areaid[34] & dd$council=="POHS",]$lme_number <- -99
dd[!is.na(dd$area) & dd$area==areaid[35],]$lme_number <- 50
dd[!is.na(dd$area) & dd$area==areaid[36],]$lme_number <- 13
dd[!is.na(dd$area) & dd$area==areaid[37],]$lme_number <- 46
dd[!is.na(dd$area) & dd$area==areaid[38],]$lme_number <- 46
dd[!is.na(dd$area) & dd$area==areaid[39],]$lme_number <- 23
dd[!is.na(dd$area) & dd$area==areaid[40],]$lme_number <- 25
dd[!is.na(dd$area) & dd$area==areaid[41],]$lme_number <- 3
dd[!is.na(dd$area) & dd$area==areaid[42],]$lme_number <- 13
dd[!is.na(dd$area) & dd$area==areaid[43],]$lme_number <- 50
dd[!is.na(dd$area) & dd$area==areaid[44],]$lme_number <- 50
dd[!is.na(dd$area) & dd$area==areaid[45],]$lme_number <- 40
dd[!is.na(dd$area) & dd$area==areaid[46],]$lme_number <- 26
dd[!is.na(dd$area) & dd$area==areaid[47],]$lme_number <- NA
dd[!is.na(dd$area) & dd$area==areaid[48],]$lme_number <- 46
dd[!is.na(dd$area) & dd$area==areaid[49],]$lme_number <- 46
dd[!is.na(dd$area) & dd$area==areaid[50],]$lme_number <- 22
dd[!is.na(dd$area) & dd$area==areaid[51],]$lme_number <- 22
dd[!is.na(dd$area) & dd$area==areaid[52],]$lme_number <- 22
dd[!is.na(dd$area) & dd$area==areaid[53],]$lme_number <- 22
dd[!is.na(dd$area) & dd$area==areaid[54],]$lme_number <- 22
dd[!is.na(dd$area) & dd$area==areaid[55],]$lme_number <- 25
dd[!is.na(dd$area) & dd$area==areaid[56],]$lme_number <- 26
dd[!is.na(dd$area) & dd$area==areaid[57],]$lme_number <- 62
dd[!is.na(dd$area) & dd$area==areaid[58],]$lme_number <- 24
dd[!is.na(dd$area) & dd$area==areaid[59],]$lme_number <- -99
dd[!is.na(dd$area) & dd$area==areaid[60],]$lme_number <- 25
dd[!is.na(dd$area) & dd$area==areaid[61],]$lme_number <- 22
dd[!is.na(dd$area) & dd$area==areaid[62],]$lme_number <- 24
dd[dd$council=="AOHS",]$lme_number <- -98
dd[dd$council=="POHS",]$lme_number <- -99
dd[dd$council=="IOHS",]$lme_number <- -97
summary(dd)
dd[is.na(dd$lme_number),]$lme_number <- 49
dd[!is.na(dd$area) & dd$area=="Northwest Pacific",]$lme_number <- 51
table(dd$lme_number)
# -99 -98 -97 -96   1   2   3   5   6   7   8   9  13  14  20  21  22  23  24  25  26  29  30  40
stock <- read.csv("277stocks_countries.csv")
dim(stock)  # 277
lme <- read.csv("stockid_lme.csv")
dim(lme)
library(dplyr)
lme_clean <- distinct(lme[,c(1,2)], stockid, .keep_all = TRUE)
dim(lme_clean)
dd <- merge(stock, lme_clean, by="stockid", all.x=TRUE)
dim(dd)
summary(dd)
check <- dd[is.na(dd$lme_number),]
areaid <- unique(check$area)
# ICES stock location: https://standardgraphs.ices.dk/stockList.aspx
dd[!is.na(dd$area) & dd$area==areaid[1],]$lme_number <- 62
dd[!is.na(dd$area) & dd$area==areaid[2],]$lme_number <- 62
dd[is.na(dd$area) & dd$stockid=="atmackerel",]$area <- "Gulf of Maine / Georges Bank"
dd[dd$stockid=="atmackerel",]$lme_number <- 7
dd[is.na(dd$area),]$lme_number <- 6
dd[!is.na(dd$area) & dd$area==areaid[4],]$lme_number <- 42
dd[!is.na(dd$area) & dd$area==areaid[5],]$lme_number <- -99
dd[!is.na(dd$area) & dd$area==areaid[6],]$lme_number <- 24
dd[!is.na(dd$area) & dd$area==areaid[7],]$lme_number <- 5
dd[!is.na(dd$area) & dd$area==areaid[8],]$lme_number <- NA
dd[!is.na(dd$area) & dd$area==areaid[9],]$lme_number <- 22
dd[!is.na(dd$area) & dd$area==areaid[10],]$lme_number <- 21
dd[!is.na(dd$area) & dd$area==areaid[11],]$lme_number <- 24
dd[!is.na(dd$area) & dd$area==areaid[12],]$lme_number <- 59
dd[!is.na(dd$area) & dd$area==areaid[13],]$lme_number <- 24
dd[!is.na(dd$area) & dd$area==areaid[14],]$lme_number <- 59
dd[!is.na(dd$area) & dd$area==areaid[15],]$lme_number <- 22
dd[!is.na(dd$area) & dd$area==areaid[16],]$lme_number <- 23
dd[!is.na(dd$area) & dd$area==areaid[17],]$lme_number <- 23
dd[!is.na(dd$area) & dd$area==areaid[18],]$lme_number <- 24
dd[!is.na(dd$area) & dd$area==areaid[19],]$lme_number <- 22
dd[!is.na(dd$area) & dd$area==areaid[20],]$lme_number <- 24
dd[!is.na(dd$area) & dd$area==areaid[21],]$lme_number <- 24
dd[!is.na(dd$area) & dd$area==areaid[22],]$lme_number <- 25
dd[!is.na(dd$area) & dd$area==areaid[23],]$lme_number <- 50
dd[!is.na(dd$area) & dd$area==areaid[24],]$lme_number <- 59
dd[!is.na(dd$area) & dd$area==areaid[25],]$lme_number <- 9
dd[!is.na(dd$area) & dd$area==areaid[26],]$lme_number <- 24
dd[!is.na(dd$area) & dd$area==areaid[27],]$lme_number <- 42
dd[!is.na(dd$area) & dd$area==areaid[28],]$lme_number <- 43
dd[!is.na(dd$area) & dd$area==areaid[29],]$lme_number <- 26
dd[!is.na(dd$area) & dd$area==areaid[30],]$lme_number <- 26
dd[!is.na(dd$area) & dd$area==areaid[31],]$lme_number <- 22
dd[!is.na(dd$area) & dd$area==areaid[32],]$lme_number <- 47
dd[!is.na(dd$area) & dd$area==areaid[33],]$lme_number <- 50
dd[!is.na(dd$area) & dd$area==areaid[34] & dd$council=="Japan",]$lme_number <- NA
dd[!is.na(dd$area) & dd$area==areaid[34] & dd$council=="POHS",]$lme_number <- -99
dd[!is.na(dd$area) & dd$area==areaid[35],]$lme_number <- 50
dd[!is.na(dd$area) & dd$area==areaid[36],]$lme_number <- 13
dd[!is.na(dd$area) & dd$area==areaid[37],]$lme_number <- 46
dd[!is.na(dd$area) & dd$area==areaid[38],]$lme_number <- 46
dd[!is.na(dd$area) & dd$area==areaid[39],]$lme_number <- 23
dd[!is.na(dd$area) & dd$area==areaid[40],]$lme_number <- 25
dd[!is.na(dd$area) & dd$area==areaid[41],]$lme_number <- 3
dd[!is.na(dd$area) & dd$area==areaid[42],]$lme_number <- 13
dd[!is.na(dd$area) & dd$area==areaid[43],]$lme_number <- 50
dd[!is.na(dd$area) & dd$area==areaid[44],]$lme_number <- 50
dd[!is.na(dd$area) & dd$area==areaid[45],]$lme_number <- 40
dd[!is.na(dd$area) & dd$area==areaid[46],]$lme_number <- 26
dd[!is.na(dd$area) & dd$area==areaid[47],]$lme_number <- NA
dd[!is.na(dd$area) & dd$area==areaid[48],]$lme_number <- 46
dd[!is.na(dd$area) & dd$area==areaid[49],]$lme_number <- 46
dd[!is.na(dd$area) & dd$area==areaid[50],]$lme_number <- 22
dd[!is.na(dd$area) & dd$area==areaid[51],]$lme_number <- 22
dd[!is.na(dd$area) & dd$area==areaid[52],]$lme_number <- 22
dd[!is.na(dd$area) & dd$area==areaid[53],]$lme_number <- 22
dd[!is.na(dd$area) & dd$area==areaid[54],]$lme_number <- 22
dd[!is.na(dd$area) & dd$area==areaid[55],]$lme_number <- 25
dd[!is.na(dd$area) & dd$area==areaid[56],]$lme_number <- 26
dd[!is.na(dd$area) & dd$area==areaid[57],]$lme_number <- 62
dd[!is.na(dd$area) & dd$area==areaid[58],]$lme_number <- 24
dd[!is.na(dd$area) & dd$area==areaid[59],]$lme_number <- -99
dd[!is.na(dd$area) & dd$area==areaid[60],]$lme_number <- 25
dd[!is.na(dd$area) & dd$area==areaid[61],]$lme_number <- 22
dd[!is.na(dd$area) & dd$area==areaid[62],]$lme_number <- 24
dd[dd$council=="AOHS",]$lme_number <- -98
dd[dd$council=="POHS",]$lme_number <- -99
dd[dd$council=="IOHS",]$lme_number <- -97
summary(dd)
dd[is.na(dd$lme_number),]$lme_number
dd[is.na(dd$lme_number),]
dd[dd$area=="Northwest Pacific",]
dd[is.na(dd$lme_number),]$lme_number <- 49
table(dd$lme_number)
dim(dd)
write.csv("277stocks_with_lme_code.csv", row.names=F)
write.csv(dd, "277stocks_with_lme_code.csv", row.names=F)
